/*

  All code by @TheDark unless noted.
  
  Minified with Toptal.

*/

var Dark=function(){let t=performance.now(),e=performance.now(),n=this;for(let s in Dark.instances.push(n),n.settings={},n.transforms=[],n.vertices=[],n.objects=Dark.objects,n.constants=Dark.constants,Dark.variables)n[s]=Dark.variables[s];n.isMain=!1;let o=Math.floor(1e9*Math.random()).toString(36),i=document.createElement("canvas");i.id="DarkJS-default-canvas-"+o,i.style.position="absolute",i.style.inset="0px",i.style.top="0px",i.style.left="0px",i.width=innerWidth,i.height=innerHeight,n.defaultCanvas=i,n.canvas=i,n.ctx=i.getContext("2d",Dark.defaultContextSettings),Dark.empties.forEach(t=>n[t]=()=>{});var r=function(t){return n.settings.angleMode==n.constants.DEGREES?t*n.constants.PI/180:t},a=function(){n.canvas.addEventListener("mousedown",function(t){t.preventDefault(),n.mouseIsPressed=!0,n.mouseButton=Dark.mouseMap[t.button],n.mousePressed()}),n.canvas.addEventListener("mouseup",function(t){t.preventDefault(),n.mouseButton=void 0,n.mouseIsPressed=!1,n.mouseReleased()}),n.canvas.addEventListener("mouseenter",function(t){t.preventDefault(),n.mouseIsInside=!0,n.mouseIn()}),n.canvas.addEventListener("mouseleave",function(t){n.mouseIsInside=!1,t.preventDefault(),n.mouseOut()}),n.canvas.addEventListener("mousemove",function(t){t.preventDefault();let e=t.target.getBoundingClientRect();n.pmouseX=n.pmouse.x=n.mouseX,n.pmouseY=n.pmouse.y=n.mouseY,n.mouseX=n.mouse.x=n.constrain(n.round(t.pageX-e.x),0,width),n.mouseY=n.mouse.y=n.constrain(n.round(t.pageY-e.y),0,height),n.mouseMoved()}),n.canvas.addEventListener("dblclick",function(t){t.preventDefault(),n.mouseDoubleClicked()})},c=function(t){return"rgba("+n.red(t)+", "+n.green(t)+", "+n.blue(t)+", "+n.alpha(t)/255+")"};!function(t){for(let e in t)n[e]=t[e]}({copy:function(t){if("object"!=typeof t)return Dark.warn('"'+t+'" is not an object!'),t;{let e={};for(let n in t)e[n]=t[n];return e}},size:function(t=innerWidth,e=innerHeight){if("number"==typeof t&&"number"==typeof e&&t>0&&e>0){let s=n.copy(n.ctx);for(let o in n.width=n.canvas.width=t,n.height=n.canvas.height=e,n.ctx){let i=s[o];"canvas"!==o&&"function"!=typeof i&&(n.ctx[o]=i)}}},setCanvas:function(t){if(t instanceof HTMLCanvasElement){n.canvas=t,n.width=t.width,n.height=t.height;let e=copy(n.ctx);for(let s in n.ctx=t.getContext("2d",Dark.defaultContextSettings),n.ctx){let o=e[s];"canvas"!==s&&"function"!=typeof o&&(n.ctx[s]=o)}n.canvas.style.cursor=n.settings.cursor,n.canvas.tabIndex="1",a()}},getCanvas:function(){return n.canvas},getContext:function(){return n.ctx},dist:function(t,e,s,o){let i=s-t,r=o-e;return n.sqrt(i*i+r*r)},gamma:function(t){return n.sqrt(n.constants.TAU/t)*((t+1/(12*t+1/(10*t)))/E)**t},factorial:function(t){return Number.isInteger(t)?intFactorial(t):gamma(t+1)},intFactorial:function(t){let e=t=n.floor(t);for(;--t>1;)e*=t;return e},choose:function(t,e){return intFactorial(t)/(intFactorial(t-e)*intFactorial(e))},random:function(...t){switch(t.length){default:return Math.random()*(t[1]-t[0])+t[0];case 0:return Math.random();case 1:return Math.random()*t[0]}},cursor:function(t="auto"){n.settings.cursor=t,n.canvas.style.cursor=t},loop:function(){n.settings.looping=!0},noLoop:function(){n.settings.looping=!1},frameRate:function(t){n.settings.frameStep=1e3/t},enableContextMenu:function(){n.settings.contextMenu=!0,n.canvas.oncontextmenu=!0},disableContextMenu:function(){n.settings.contextMenu=!1,n.canvas.oncontextmenu=!1},format:function(t){return"object"==typeof t&&null!==t?JSON.stringify(copy(t),null,"    "):t+""},color:function(t,e,s,o){return 1==arguments.length&&(s=e=t),2==arguments.length&&(o=e,e=t,s=t),o||(o=255),t=n.constrain(t,0,255),e=n.constrain(e,0,255),s=n.constrain(s,0,255),((o=n.constrain(o,0,255))<<24)+(t<<16)+(e<<8)+s},red:t=>t>>16&255,green:t=>t>>8&255,blue:t=>255&t,alpha:t=>t>>24&255,lerpColor:function(t,e,s){return color(n.lerp(n.red(t),n.red(e),s),n.lerp(n.green(t),n.green(e),s),n.lerp(n.blue(t),n.blue(e),s),n.lerp(n.alpha(t),n.alpha(e),s))},fill:function(...t){let e=n.settings.fill=n.color.apply(null,t);n.ctx.fillStyle=c(e)},noFill:function(){n.settings.fill=0,n.ctx.fillStyle="rgba(0, 0, 0, 0)"},stroke:function(...t){let e=n.settings.stroke=n.color.apply(null,t);n.ctx.strokeStyle=c(e)},noStroke:function(){n.settings.stroke=0,n.ctx.strokeStyle="rgba(0, 0, 0, 0)"},background:function(...t){n.ctx.save();let e=n.color.apply(null,t);n.ctx.fillStyle=c(e),n.ctx.fillRect(0,0,n.width,n.height),n.ctx.restore()},clear:function(){n.ctx.clearRect(0,0,n.width,n.height)},strokeCap:function(t){switch(t){default:Dark.error(Error("Invalid strokeCap type"));break;case n.constants.FLAT:n.ctx.lineCap="butt",n.settings.strokeCap=n.constants.FLAT;break;case n.constants.ROUND:n.ctx.lineCap="round",n.settings.strokeCap=n.constants.ROUND}},strokeWeight:function(t){n.settings.strokeWeight=t,n.ctx.lineWidth=t},smooth:function(){n.settings.smoothing=!0,n.ctx.imageSmoothingEnabled=!0,n.ctx.imageSmoothingQuality="high"},noSmooth:function(){n.settings.smoothing=!0,n.ctx.imageSmoothingEnabled=!1,n.ctx.imageSmoothingQuality="low"},angleMode:function(t){switch(t){default:Dark.error(Error("Invalid angleMode type"));break;case n.constants.DEGREES:n.settings.angleMode=n.constants.DEGREES;break;case n.constants.RADIANS:n.settings.angleMode=n.constants.RADIANS}},ellipseMode:function(t=n.constants.CENTER){n.settings.ellipseMode=t},rectMode:function(t=n.constants.CORNER){n.settings.rectMode=t},imageMode:function(t=n.constants.CORNER){n.settings.imageMode=t},curveTightness:function(t=0){n.settings.curveTightness=t},pushMatrix:function(){n.transforms.length>n.maxTransforms?Dark.error("Maximum matrix stack size reached, pushMatrix() called "+n.maxTransforms+" times."):n.transforms.push(n.ctx.getTransform())},popMatrix:function(){let t=n.transforms.pop();t?n.ctx.setTransform(t):Dark.error(Error("No more transforms to restore in popMatrix"))},resetMatrix:function(){n.transforms.length=0},translate:function(t,e){n.ctx.translate(t,e)},rotate:function(t){n.ctx.rotate(r(t))},scale:function(t,e){arguments.length<2?n.ctx.scale(t,t):n.ctx.scale(t,e)},skew:function(t,e=0){let s=n.ctx.getTransform();s.b=.01*e,s.c=.01*t,n.ctx.setTransform(s)},rect:function(t,e,s,o){s=Math.abs(s),o=Math.abs(o),n.ctx.beginPath(),n.ctx.save(),n.settings.rectMode==n.constants.CENTER&&n.ctx.translate(-s/2,-o/2),n.ctx.rect(t,e,s,o),n.ctx.fill(),n.ctx.stroke(),n.ctx.restore()},ellipse:function(t,e,s,o){s=Math.abs(s),o=Math.abs(o),n.ctx.beginPath(),n.ctx.save(),n.settings.ellipseMode==n.constants.CORNER&&n.ctx.translate(s/2,o/2),n.ctx.beginPath(),n.ctx.ellipse(t,e,s/2,o/2,0,0,n.constants.TAU,!1),n.ctx.fill(),n.ctx.stroke(),n.ctx.restore()},arc:function(t,e,s,o,i,r){n.ctx.save(),n.settings.ellipseMode==n.constants.CORNER&&n.ctx.translate(s/2,o/2),n.ctx.beginPath(),n.ctx.ellipse(t,e,s/2,o/2,0,i,r,!1),n.ctx.fill(),n.ctx.stroke(),n.ctx.restore()},line:function(t,e,s,o){n.ctx.beginPath(),n.ctx.moveTo(t,e),n.ctx.lineTo(s,o),n.ctx.stroke()},point:function(t,e){n.ctx.save(),n.ctx.beginPath(),n.ctx.fillStyle="rgba(0, 0, 0, 1)",n.settings.ellipseMode==n.constants.CORNER&&n.ctx.translate(width/2,height/2),n.ctx.fill(),n.ctx.restore()},circle:function(t,e,s){n.ctx.save(),n.settings.ellipseMode==n.constants.CORNER&&n.ctx.translate(s,s),n.ctx.beginPath(),n.ctx.arc(t,e,s,0,n.constants.TAU),n.ctx.fill(),n.ctx.stroke(),n.ctx.restore()},square:function(t,e,n){rect(t,e,n,n)},triangle:function(t,e,s,o,i,r){n.ctx.beginPath(),n.ctx.moveTo(t,e),n.ctx.lineTo(s,o),n.ctx.lineTo(i,r),n.ctx.closePath(),n.ctx.fill(),n.ctx.stroke()},quad:function(t,e,s,o,i,r,a,c){n.ctx.beginPath(),n.ctx.moveTo(t,e),n.ctx.lineTo(s,o),n.ctx.lineTo(i,r),n.ctx.lineTo(a,c),n.ctx.closePath(),n.ctx.fill(),n.ctx.stroke()},beginShape:function(){n.vertices.length=0},endShape:function(t=n.constants.OPEN){n.vertices.length<2||n.vertices[0].type!=n.constants.VERTEX||(n.ctx.beginPath(),n.vertices.forEach(function(t,e){if(0==e)n.ctx.moveTo(t.point.x,t.point.y);else switch(t.type){case n.constants.VERTEX:let s=t.point;n.ctx.lineTo(s.x,s.y);break;case n.constants.CURVE:t.node;break;case n.constants.BEZIER:let o=t.points;n.ctx.bezierCurveTo(o[0].x,o[0].y,o[1].x,o[1].y,o[2].x,o[2].y);case n.constants.SMOOTH:}}),t==n.constants.CLOSE&&n.ctx.closePath(),n.ctx.fill(),n.ctx.stroke())},vertex:function(t,e){n.vertices.push({type:n.constants.VERTEX,point:{x:t,y:e}})},curveVertex:function(t,e){n.vertices.push({type:n.constants.CURVE,node:{x:t,y:e}})},smoothVertex:function(t,e){n.vertices.push({type:n.constants.SMOOTH,node:{x:t,y:e}})},bezierVertex:function(t,e,s,o,i,r){n.vertices.push({type:n.constants.BEZIER,points:[{x:t,y:e},{x:s,y:o},{x:i,y:r}]})},bezier:function(t,e,n,s,o,i,r,a){beginShape(),vertex(t,e),bezierVertex(n,s,o,i,r,a),endShape()},reloadFont:function(){n.ctx.font=n.settings.font.toString()},textSize:function(t){n.settings.textSize=t,n.settings.font.size=t,n.reloadFont()},textFont:function(t){"string"==typeof t&&(t=new n.objects.DFont(t)),t instanceof n.objects.DFont?(n.settings.font=t,n.settings.textSize=t.size,n.reloadFont()):Dark.error(t+" is not a DFont.")},textStyle:function(t){switch(t){default:n.settings.font.weight="normal",n.settings.font.style="normal";break;case n.constants.BOLD:n.settings.font.weight="bold";break;case n.constants.ITALIC:n.settings.font.style="italic"}n.reloadFont()},text:function(t,e,s){n.ctx.fillText(t,e,s),n.ctx.strokeText(t,e,s)},get:function(...t){return 0==t.length?new DImage(n.ctx.getImageData(0,0,width,height),n.canvas):4==t.length?new DImage(n.ctx.getImageData(t[0],t[1],t[2],t[3]),n.canvas):void Dark.error(Error("get requires 0 or 4 parameters, not "+t.length))},set:function(t,e,s){n.ctx.save(),n.ctx.fillStyle=n.helper.colorString(s),n.ctx.fillRect(t,e,1,1),n.ctx.restore()},image:function(t,e,s,o,i){switch(n.ctx.save(),n.settings.imageMode==n.constants.CENTER&&n.ctx.translate(-o/2,-i/2),arguments.length){default:Dark.error(Error("image requires 3 to 5 parameters, not "+arguments.length));break;case 3:n.ctx.drawImage(t.canvas,e,s);break;case 4:n.ctx.drawImage(t.canvas,e,s,o,o);break;case 5:n.ctx.drawImage(t.canvas,e,s,o,i)}n.ctx.restore()},min:(t,e)=>t<e?t:e,max:(t,e)=>t>e?t:e,log10:t=>Math.log10(t),log2:t=>Math.log2(t),log:t=>Math.log(t),logBase:(t,e)=>Math.log(t)/Math.log(e),mag:(t,e)=>Math.sqrt(t*t+e*e),norm:(t,e,n)=>(t-e)/(n-e),constrain:(t,e,n)=>Math.min(Math.max(t,e),n),lerp:(t,e,n)=>(e-t)*n+t,map:(t,e,n,s,o)=>s+(o-s)/(n-e)*(value-e),sq:t=>t*t,cb:t=>t*t*t,pow:(t,e)=>t**e,root:(t,e)=>t**(1/e),sqrt:t=>Math.sqrt(t),cbrt:t=>Math.cbrt(t),exp:t=>E**t,floor:t=>Math.floor(t),round:t=>Math.round(t),ceil:t=>Math.ceil(t),trunc:t=>Math.trunc(t),deci:t=>t-Math.trunc(t),abs:t=>t<0?-t:t,sign:t=>Math.sign(t),bsign:t=>t<0?-1:1,degrees:t=>180*t/n.constants.PI,radians:t=>t*n.constants.PI/180,millennium:()=>Math.floor(new Date().getFullYear()/1e3),century:()=>Math.floor(new Date().getFullYear()/100),decade:()=>Math.floor(new Date().getFullYear()/10),year:()=>new Date().getFullYear(),month:()=>new Date().getMonth(),day:()=>new Date().getDate(),hour:()=>new Date().getHours(),minute:()=>new Date().getMinutes(),second:()=>new Date().getSeconds(),millis:()=>Math.floor(performance.now()),micro:()=>Math.floor(1e3*performance.now()%1e3),nano:()=>Math.floor(1e6*performance.now()%1e3),today:()=>DAYS[new Date().getDay()],timezone:()=>-new Date().getTimezoneOffset()/60,sin:t=>Math.sin(r(t)),cos:t=>Math.cos(r(t)),tan:t=>Math.tan(r(t)),csc:t=>1/Math.sin(r(t)),sec:t=>1/Math.cos(r(t)),cot:t=>1/Math.tan(r(t)),atan2(t,e){var s;return s=Math.atan2(t,e),n.settings.angleMode==n.constants.DEGREES?180*s/n.constants.PI:s},asin:t=>Math.asin(r(t)),acos:t=>Math.acos(r(t)),atan:t=>Math.atan(r(t)),acsc:t=>Math.asin(1/r(t)),asec:t=>Math.acos(1/r(t)),acot:t=>Math.atan(1/r(t)),sinh:t=>Math.sinh(r(t)),cosh:t=>Math.cosh(r(t)),tanh:t=>Math.tanh(r(t)),csch:t=>1/Math.sinh(r(t)),sech:t=>1/Math.cosh(r(t)),coth:t=>1/Math.tanh(r(t)),asinh:t=>Math.asinh(r(t)),acosh:t=>Math.acosh(r(t)),atanh:t=>Math.atanh(r(t)),acsch:t=>Math.asinh(1/r(t)),asech:t=>Math.acosh(1/r(t)),acoth:t=>Math.atanh(1/r(t)),now:()=>performance.now(),reciprocal:t=>1/t}),n.raf=function(s){let o=s-t,i=s-e;n.isMain&&Dark.globallyUpdateVariables(n),o>n.settings.frameStep-i/2&&n.settings.looping&&(n.dt=dt=o,n.fps=fps=1e3/dt,n.frameCount=++n.frameCount,n.draw(),t=performance.now()),e=performance.now(),requestAnimationFrame(n.raf)},requestAnimationFrame(n.raf),n.frameRate(60),n.smooth(),n.ellipseMode(n.constants.CENTER),n.rectMode(n.constants.CORNER),n.imageMode(n.constants.CORNER),n.angleMode(n.constants.DEGREES),n.strokeCap(n.constants.ROUND),n.fill(255),n.stroke(0),n.strokeWeight(1),n.textFont("12px Arial"),document.addEventListener("keydown",function(t){t.preventDefault(),n.keyIsPressed=!0,n.key=t.key,n.keyCode=t.keyCode,n.keyPressed()}),document.addEventListener("keyup",function(t){t.preventDefault(),n.keyIsPressed=!1,n.key=void 0,n.keyCode=void 0,n.keyReleased()}),document.addEventListener("keypress",function(t){t.preventDefault(),n.keyTyped()}),n.mouse=n.objects.DVector.zero2D(),n.pmouse=n.objects.DVector.zero2D(),n.settings.cursor="auto",n.settings.looping=!0};Dark.instances=[],Dark.empties=["draw","keyPressed","keyReleased","keyTyped","mousePressed","mouseReleased","mouseMoved","mouseIn","mouseOut","mouseDoubleClicked"],Dark.constants={DAYS:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],PI:Math.PI,HALF_PI:Math.PI/2,QUARTER_PI:Math.PI/4,E:Math.E,PHI:Math.PHI,TAU:2*Math.PI,ROUND:0,FLAT:1,DEGREES:2,RADIANS:3,VERTEX:4,CURVE:5,SMOOTH:6,BEZIER:7,CLOSE:8,OPEN:9,CENTER:10,CORNER:11,BOLD:12,ITALIC:13,NORMAL:14},Dark.ignoreGlobal=["empties","raf","vertices","transforms","settings","isMain","defaultCanvas","canvas","ctx"],Dark.variables={width:innerWidth,height:innerHeight,dt:0,frameCount:0,fps:60,key:void 0,keyCode:void 0,keyIsPressed:!1,mouseIsPressed:!1,mouseIsInside:!1,mouseX:0,mouseY:0,pmouseX:0,pmouseY:0,mouse:void 0,pmouse:void 0,mouseButton:void 0},Dark.mouseMap=["left","middle","right","back","forward"],Dark.errorCount=0,Dark.maxErrorCount=50,Dark.maxTransforms=1e3,Dark.defaultContextSettings={willReadFrequently:!0},Dark.copy=function(t){if("object"!=typeof t&&"function"!=typeof t)return Dark.warn('"'+t+'" is not an object!'),t;{let e={};for(let n in t)e[n]=t[n];return"function"==typeof t&&0==Object.keys(e).length?t:e}},Dark.format=function(t){return"object"==typeof Dark.copy(t)&&("object"==typeof t||"function"==typeof t)?JSON.stringify(Dark.copy(t),null,"    "):t+""},Dark.doError=function(t,e){Dark.errorCount==Dark.maxErrorCount?console.warn("Too many warnings and errors have been made, the rest will not display."):Dark.errorCount<Dark.maxErrorCount&&console[t](e),Dark.errorCount++},Dark.warn=function(t){Dark.doError("warn",t)},Dark.error=function(t){Dark.doError("error",t)},Dark.setMain=function(t){t instanceof Dark?(Dark.main&&(Dark.main.isMain=!1),Dark.main=t,t.isMain=!0):Dark.error(t+" is not an instance of Dark")},Dark.getMain=function(){return Dark.main},Dark.globallyUpdateVariables=function(t){for(let e in Dark.empties.forEach(function(e){window[e]&&(t[e]=window[e])}),t)if(!Dark.ignoreGlobal.includes(e)&&!Dark.empties.includes(e)){if("object"==typeof t[e])for(let n in t[e])window[n]=t[e][n];else window[e]=t[e]}},Dark.objects=function(){let t=function(t,e,n){this.x=t,this.y=e,this.z=n};t.create=function(e,n,s){return new t(e,n,s)},t.zero2D=function(){return new t(0,0)},t.zero3D=function(){return new t(0,0,0)},t.add=function(e,n){return n instanceof t?new t(e.x+n.x,e.y+n.y,e.z+n.z):new t(e.x+n,e.y+n,e.z+n)},t.prototype.add=function(e){e instanceof t?(this.x+=e.x,this.y+=e.y,this.z+=e.z):(this.x+=e,this.y+=e,this.z+=e)},t.sub=function(e,n){return n instanceof t?new t(e.x-n.x,e.y-n.y,e.z-n.z):new t(e.x-n,e.y-n,e.z-n)},t.prototype.sub=function(e){e instanceof t?(this.x-=e.x,this.y-=e.y,this.z-=e.z):(this.x-=e,this.y-=e,this.z-=e)},t.mult=function(e,n){return n instanceof t?new t(e.x*n.x,e.y*n.y,e.z*n.z):new t(e.x*n,e.y*n,e.z*n)},t.prototype.mult=function(e){e instanceof t?(this.x*=e.x,this.y*=e.y,this.z*=e.z):(this.x*=e,this.y*=e,this.z*=e)},t.div=function(e,n){return n instanceof t?new t(e.x/n.x,e.y/n.y,e.z/n.z):new t(e.x/n,e.y/n,e.z/n)},t.prototype.div=function(e){e instanceof t?(this.x/=e.x,this.y/=e.y,this.z/=e.z):(this.x/=e,this.y/=e,this.z/=e)},t.pow=function(e,n){return n instanceof t?new t(e.x**n.x,e.y**n.y,e.z**n.z):new t(e.x**n,e.y**n,e.z**n)},t.prototype.pow=function(e){e instanceof t?(this.x**=e.x,this.y**=e.y,this.z**=e.z):(this.x**=e,this.y**=e,this.z**=e)},t.mag=function(t){return t.mag()},t.prototype.mag=function(){return this.z?Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z):Math.sqrt(this.x*this.x+this.y*this.y)},t.magSq=function(t){return t.magSq()},t.prototype.magSq=function(){return this.z?this.x*this.x+this.y*this.y+this.z*this.z:this.x*this.x+this.y*this.y},t.normalize=function(e){let n=e.mag();if(0!=n)return t.div(e,n)},t.prototype.normalize=function(){let t=this.mag();0!=t&&this.div(t)},t.cross=function(e,n){return new t(e.y*n.z-n.y*e.z,e.z*n.x-n.z*e.x,e.x*n.y-n.x*e.y)},t.prototype.cross=function(t){return this.cross(t)},t.dot=function(t,e){return"number"==typeof e?t.z?t.x*e+t.y*e+t.z*e:t.x*e+t.y*e:t.z&&e.z?t.x*e.x+t.y*e.y+t.z*e.z:t.x*e.x+t.y*e.y},t.prototype.dot=function(e){return t.dot(this,e)},t.flip=function(t){return new Vector(-t.x,-t.y,-t.z)},t.prototype.flip=function(){this.x=-this.x,this.y=-this.y,this.z=-this.z},t.limit=function(t,e){return t.mag()>e&&t.mult(e/t.mag()),t},t.prototype.limit=function(){this.mag()>max&&this.mult(max/this.mag())},t.lerp=function(e,n,s){return new t(Dark.main.lerp(e.x,n.x,s),Dark.main.lerp(e.y,n.y,s),Dark.main.lerp(e.z,n.z,s))},t.prototype.lerp=function(e,n){return t.lerp(this,e,n)},t.get=function(t){return t.get()},t.prototype.get=function(){return new t(this.x,this.y,this.z)},t.prototype.set=function(t){[this.x,this.y,this.z]=[t.x,t.y,t.z]},t.prototype.array=function(){return[this.x,this.y,this.z]},t.prototype.toString=function(){return this.z?"["+this.x+", "+this.y+", "+this.z+"]":"["+this.x+", "+this.y+"]"};let e=function(t){this.style="normal",this.variant="normal",this.weight="normal",this.size=16,this.family="Arial";let n=t.split(" ");for(let s in n){let o=n[s];switch(o){case"normal":break;case"italic":this.style="italic";break;case"bold":this.weight="bold"}if("italic"==o)this.style="italic";else if("small-caps"==o)this.variant="small-caps";else if(e.weights.includes(o))this.weight=o;else if("normal"!==o){let i=parseInt(o);isNaN(i)?this.family=o:this.size=i}}};e.parse=function(t){return new e(t)},e.prototype.toString=function(){return this.style+" "+this.weight+" "+this.variant+" "+this.size+"px "+this.family},e.weights=["bold","bolder","lighter","100","200","300","400","500","600","700","800","900"];let n=function(t,e){this.width=t.width,this.height=t.height,this.imageData=t,this.source=e,this.canvas=new OffscreenCanvas(this.width,this.height),this.ctx=this.canvas.getContext("2d",Dark.defaultContextSettings),this.ctx.putImageData(t,0,0)};n.prototype.get=function(...t){return 0==t.length?this.copy():4==t.length?new n(this.ctx.getImageData(t[0],t[1],t[2],t[3]),this.source):void Dark.error(Error("DImage.get requires 0 or 4 parameters, not "+t.length))},n.prototype.copy=function(){return new n(this.imageData,this.source)};let s=function(t,e,n=0){t instanceof s?(this.width=t.width,this.height=t.height,this.mat=Array(this.height).fill(null).map(()=>Array(this.width).fill(0)),this.set(t)):Array.isArray(t)?(Array.isArray(t[0])?(this.width=t[0].length,this.height=t.length):(this.width=e,this.height=n),this.mat=Array(this.height).fill(null).map(()=>Array(this.width).fill(0)),this.set(t)):(this.width=t,this.height=e,this.mat=Array(e).fill(null).map(()=>Array(t).fill(n)))};return s.prototype.get=function(t,e){return this.mat[e][t]},s.set=function(t,e,n,s){t.set(e,n,s)},s.prototype.set=function(t,e,n){if(t instanceof s)for(let o=0;o<t.height;o++)for(let i=0;i<t.width;i++)this.mat[o][i]=t.mat[o][i];else if(Array.isArray(t)){if(Array.isArray(t[0]))for(let r=0;r<t.length;r++)for(let a=0;a<t[0].length;a++)this.mat[r][a]=t[r][a];else for(let c=0;c<this.width*this.height;c++){let l=c%this.width,u=Math.floor(c/this.width);this.mat[u][l]=t[c]}}else this.mat[e][t]=n},s.dot=function(t,e,n,s){if(t.width==e.height&&t.height==e.width){let o=0;for(let i=0;i<t.width;i++)o+=t.get(i,n)*e.get(s,i);return o}Dark.error(Error("Can only take the dot product of two DMatrices with opposite dimensions"))},s.prototype.dot=function(t){return s.dot(this,t)},s.add=function(t,e){if(t.width==e.width&&t.height==e.height){let n=new s(t.width,t.height);for(let o=0;o<n.height;o++)for(let i=0;i<n.width;i++)n.set(o,i,t.get(i,o)+e.get(i,o));return n}Dark.error(Error("Cannot add two DMatrices with different dimensions"))},s.prototype.add=function(t){this.set(s.add(this,t))},s.sub=function(t,e){if(t.width==e.width&&t.height==e.height){let n=new s(t.width,t.height);for(let o=0;o<n.height;o++)for(let i=0;i<n.width;i++)n.set(o,i,t.get(i,o)-e.get(i,o));return n}Dark.error(Error("Cannot subtract two DMatrices with different dimensions"))},s.prototype.sub=function(t){this.set(s.sub(this,t))},s.mult=function(t,e){if(t.width==e.height&&t.height==e.width){let n=t.height,o=new s(n,n);for(let i=0;i<n;i++)for(let r=0;r<n;r++)o.set(r,i,s.dot(t,e,i,r));return o}Dark.error(Error("Can only multiply two DMatrices with opposite dimensions"))},s.prototype.toString=function(){let t="";for(let e in this.mat){for(let n in this.mat[e])t+=this.mat[e][n]+" ";t=t.replace(/ $/,"\n")}return t},{DVector:t,DFont:e,DImage:n,DMatrix:s}}(),Dark.setMain(new Dark),Dark.globallyUpdateVariables(Dark.main),Object.freeze(Dark);
