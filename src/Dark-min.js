/*

  All code by @99TheDark unless noted. (See Credits.md)
  
  Minified with Toptal.

*/

var Dark=function(t=!1){let e=performance.now(),n=performance.now(),i=-1,s=this,r=Dark.constants;for(let o in Dark.instances.push(s),s.settings={},s.transforms=[],s.vertices=[],s.vertexCache=[],s.objects=Dark.objects,r=s.constants=Dark.constants,s.dummy=t,Dark.variables)s[o]=Dark.variables[o];s.isMain=!1;let c=Math.floor(1e9*Math.random()).toString(36),l=document.createElement("canvas");l.id="DarkJS-default-canvas-"+c,l.style.position="absolute",l.style.inset="0px",l.style.top="0px",l.style.left="0px",l.width=innerWidth,l.height=innerHeight,s.defaultCanvas=l,s.canvas=l,s.ctx=l.getContext("2d",Dark.defaultContextSettings),Dark.empties.forEach(t=>s[t]=()=>{});var u=function(t){return s.settings.angleMode==r.DEGREES?t*r.PI/180:t},h=function(t){s.vertices.push(t),t.points.forEach(t=>s.vertexCache.push(new DVector(t.x,t.y)))},f=function(){s.canvas.addEventListener("mousedown",function(t){t.preventDefault(),s.mouseIsPressed=!0,s.mouseButton=Dark.mouseMap[t.button],s.mousePressed()}),s.canvas.addEventListener("mouseup",function(t){t.preventDefault(),s.mouseButton=void 0,s.mouseIsPressed=!1,s.mouseReleased()}),s.canvas.addEventListener("mouseenter",function(t){t.preventDefault(),s.mouseIsInside=!0,s.mouseIn()}),s.canvas.addEventListener("mouseleave",function(t){s.mouseIsInside=!1,t.preventDefault(),s.mouseOut()}),s.canvas.addEventListener("mousemove",function(t){t.preventDefault();let e=t.target.getBoundingClientRect();s.pmouseX=s.pmouse.x=s.mouseX,s.pmouseY=s.pmouse.y=s.mouseY,s.mouseX=s.mouse.x=s.constrain(s.round(t.pageX-e.x),0,width),s.mouseY=s.mouse.y=s.constrain(s.round(t.pageY-e.y),0,height),s.mouseMoved()}),s.canvas.addEventListener("wheel",function(t){t.preventDefault(),s.mouseScrolled()}),s.canvas.addEventListener("dblclick",function(t){t.preventDefault(),s.mouseDoubleClicked()})},g=function(t){return"rgba("+s.red(t)+", "+s.green(t)+", "+s.blue(t)+", "+s.alpha(t)/255+")"};!function(t){for(let e in t)s[e]=t[e]}({copy:function(t){if("object"!=typeof t)return Dark.warn('"'+t+'" is not an object!'),t;{let e={};for(let n in t)e[n]=t[n];return e}},size:function(t=innerWidth,e=innerHeight){if("number"==typeof t&&"number"==typeof e&&t>0&&e>0){let n=s.copy(s.ctx);for(let i in s.width=s.canvas.width=t,s.height=s.canvas.height=e,s.ctx){let r=n[i];"canvas"!==i&&"function"!=typeof r&&(s.ctx[i]=r)}}},setCanvas:function(t){if(t instanceof HTMLCanvasElement){s.canvas=t,s.width=t.width,s.height=t.height;let e=copy(s.ctx);for(let n in s.ctx=t.getContext("2d",Dark.defaultContextSettings),s.ctx){let i=e[n];"canvas"!==n&&"function"!=typeof i&&(s.ctx[n]=i)}s.canvas.style.cursor=s.settings.cursor,s.canvas.tabIndex="1",f()}},getCanvas:function(){return s.canvas},getContext:function(){return s.ctx},setTitle:function(t){document.title=t},dist:function(...t){let e,n;return t.length=6,e=t[2]-t[0],n=t[3]-t[1],s.sqrt(e*e+n*n+0)},gamma:function(t){return s.sqrt(r.TAU/t)*((t+1/(12*t+1/(10*t)))/E)**t},factorial:function(t){return Number.isInteger(t)?intFactorial(t):gamma(t+1)},intFactorial:function(t){let e=t=s.floor(t);for(;--t>1;)e*=t;return e},choose:function(t,e){return intFactorial(t)/(intFactorial(t-e)*intFactorial(e))},random:function(...t){switch(t.length){default:return Math.random()*(t[1]-t[0])+t[0];case 0:return Math.random();case 1:return Math.random()*t[0]}},cursor:function(t="auto"){s.settings.cursor=t,s.canvas.style.cursor=t},noCursor:function(){s.settings.cursor="none",s.canvas.style.cursor="none"},loop:function(){s.settings.looping=!0},noLoop:function(){s.settings.looping=!1},frameRate:function(t){s.settings.frameStep=1e3/t},enableContextMenu:function(){s.settings.contextMenu=!0,s.canvas.oncontextmenu=!0},disableContextMenu:function(){s.settings.contextMenu=!1,s.canvas.oncontextmenu=!1},format:function(t){return"object"==typeof t&&null!==t?JSON.stringify(copy(t),null,"    "):t+""},color:function(t,e,n,i){if(1==arguments.length){if(!(t<=255)||!(t>=0))return t;n=e=t}return 2==arguments.length&&(i=e,e=t,n=t),i||(i=255),t=s.constrain(t,0,255),e=s.constrain(e,0,255),n=s.constrain(n,0,255),((i=s.constrain(i,0,255))<<24)+(t<<16)+(e<<8)+n},randomColor:function(){return color(255*Math.random(),255*Math.random(),255*Math.random())},red:t=>t>>16&255,green:t=>t>>8&255,blue:t=>255&t,alpha:t=>t>>24&255,lerpColor:function(t,e,n){return color(s.lerp(s.red(t),s.red(e),n),s.lerp(s.green(t),s.green(e),n),s.lerp(s.blue(t),s.blue(e),n),s.lerp(s.alpha(t),s.alpha(e),n))},fill:function(...t){let e=s.settings.fill=s.color.apply(null,t);s.ctx.fillStyle=g(e)},noFill:function(){s.settings.fill=0,s.ctx.fillStyle="rgba(0, 0, 0, 0)"},stroke:function(...t){let e=s.settings.stroke=s.color.apply(null,t);s.ctx.strokeStyle=g(e)},noStroke:function(){s.settings.stroke=0,s.ctx.strokeStyle="rgba(0, 0, 0, 0)"},background:function(...t){s.ctx.save(),s.ctx.resetTransform();let e=s.color.apply(null,t);s.ctx.fillStyle=g(e),s.ctx.fillRect(0,0,s.width,s.height),s.ctx.restore()},clear:function(){s.ctx.save(),s.dtx.resetTransform(),s.ctx.clearRect(0,0,s.width,s.height),s.restore()},strokeCap:function(t){switch(t){default:Dark.error(Error("Invalid strokeCap type"));break;case r.FLAT:s.ctx.lineCap="butt",s.settings.strokeCap=r.FLAT;break;case r.ROUND:s.ctx.lineCap="round",s.settings.strokeCap=r.ROUND;break;case r.SQUARE:s.ctx.lineCap="square",s.settings.strokeCap=r.SQUARE}},strokeJoin:function(t=r.MITER){switch(t){default:Dark.error(Error("Invalid strokeJoin type"));break;case r.MITER:s.ctx.lineJoin="miter",s.settings.strokeJoin=r.MITER;break;case r.BEVEL:s.ctx.lineJoin="bevel",s.settings.strokeJoin=r.BEVEL;break;case r.ROUND:s.ctx.lineJoin="round",s.settings.strokeJoin=r.ROUND}},strokeWeight:function(t){s.settings.strokeWeight=t,s.ctx.lineWidth=t},smooth:function(){s.settings.smoothing=!0,s.ctx.imageSmoothingEnabled=!0,s.ctx.imageSmoothingQuality="high"},noSmooth:function(){s.settings.smoothing=!0,s.ctx.imageSmoothingEnabled=!1,s.ctx.imageSmoothingQuality="low"},angleMode:function(t){switch(t){default:Dark.error(Error("Invalid angleMode type"));break;case r.DEGREES:s.settings.angleMode=r.DEGREES;break;case r.RADIANS:s.settings.angleMode=r.RADIANS}},ellipseMode:function(t=r.CENTER){s.settings.ellipseMode=t},rectMode:function(t=r.CORNER){s.settings.rectMode=t},imageMode:function(t=r.CORNER){s.settings.imageMode=t},curveTightness:function(t=0){s.settings.curveTightness=t},pushMatrix:function(){s.transforms.length>s.maxTransforms?Dark.error("Maximum matrix stack size reached, pushMatrix() called "+s.maxTransforms+" times."):s.transforms.push(s.ctx.getTransform())},popMatrix:function(){let t=s.transforms.pop();t?s.ctx.setTransform(t):Dark.error(Error("No more transforms to restore in popMatrix"))},resetMatrix:function(){s.transforms.length=0},push:function(){s.ctx.save()},pop:function(){s.ctx.restore()},reset:function(){s.ctx.reset()},translate:function(t,e){s.ctx.translate(t,e)},rotate:function(t){s.ctx.rotate(u(t))},scale:function(t,e){arguments.length<2?s.ctx.scale(t,t):s.ctx.scale(t,e)},skew:function(t,e=0){let n=s.ctx.getTransform();n.b=.01*e,n.c=.01*t,s.ctx.setTransform(n)},rect:function(t,e,n,i){n=Math.abs(n),i=Math.abs(i),s.ctx.beginPath(),s.ctx.save(),s.settings.rectMode==r.CENTER&&s.ctx.translate(-n/2,-i/2),s.ctx.rect(t,e,n,i),s.ctx.fill(),s.ctx.stroke(),s.ctx.restore()},ellipse:function(t,e,n,i){n=Math.abs(n),i=Math.abs(i),s.ctx.beginPath(),s.ctx.save(),s.settings.ellipseMode==r.CORNER&&s.ctx.translate(n/2,i/2),s.ctx.beginPath(),s.ctx.ellipse(t,e,n/2,i/2,0,0,r.TAU,!1),s.ctx.fill(),s.ctx.stroke(),s.ctx.restore()},arc:function(t,e,n,i,o,c){s.ctx.save(),s.settings.ellipseMode==r.CORNER&&s.ctx.translate(n/2,i/2),s.ctx.beginPath(),s.ctx.ellipse(t,e,n/2,i/2,0,o,c,!1),s.ctx.fill(),s.ctx.stroke(),s.ctx.restore()},line:function(t,e,n,i){s.ctx.beginPath(),s.ctx.moveTo(t,e),s.ctx.lineTo(n,i),s.ctx.stroke()},point:function(t,e){s.ctx.save(),s.ctx.beginPath(),s.ctx.fillStyle=g(s.settings.stroke),s.ctx.arc(t,e,s.settings.strokeWeight/2,0,r.TAU),s.ctx.fill(),s.ctx.restore()},circle:function(t,e,n){s.ctx.save(),s.settings.ellipseMode==r.CORNER&&s.ctx.translate(n,n),s.ctx.beginPath(),s.ctx.arc(t,e,n,0,r.TAU),s.ctx.fill(),s.ctx.stroke(),s.ctx.restore()},square:function(t,e,n){rect(t,e,n,n)},triangle:function(t,e,n,i,r,o){s.ctx.beginPath(),s.ctx.moveTo(t,e),s.ctx.lineTo(n,i),s.ctx.lineTo(r,o),s.ctx.closePath(),s.ctx.fill(),s.ctx.stroke()},quad:function(t,e,n,i,r,o,c,l){s.ctx.beginPath(),s.ctx.moveTo(t,e),s.ctx.lineTo(n,i),s.ctx.lineTo(r,o),s.ctx.lineTo(c,l),s.ctx.closePath(),s.ctx.fill(),s.ctx.stroke()},beginShape:function(){s.vertices.length=0,s.vertexCache.length=0},endShape:function(t=r.OPEN){s.vertices.length<2||s.vertices[0].type==r.BEZIER||(s.ctx.beginPath(),s.vertices.forEach(function(t,e){if(0==e)s.ctx.moveTo(t.points[0].x,t.points[0].y);else switch(t.type){case r.VERTEX:let n=t.points[0];s.ctx.lineTo(n.x,n.y);break;case r.CURVE:let i=(s.settings.curveTightness-1)/6,o=s.vertexCache[e-3],c=s.vertexCache[e-2],l=s.vertexCache[e-1],u=s.vertexCache[e];0==e?s.ctx.moveTo(u.x,u.y):e<3?s.ctx.lineTo(u.x,u.y):(3==e&&s.ctx.lineTo(c.x,c.y),s.ctx.bezierCurveTo(l.x*i+c.x-o.x*i,l.y*i+c.y-o.y*i,-(u.x*i)+l.x+c.x*i,-(u.y*i)+l.y+c.y*i,l.x,l.y));break;case r.BEZIER:let h=t.points;s.ctx.bezierCurveTo(h[0].x,h[0].y,h[1].x,h[1].y,h[2].x,h[2].y);case r.SMOOTH:}}),t==r.CLOSE&&s.ctx.closePath(),s.ctx.fill(),s.ctx.stroke())},vertex:function(t,e){h({type:r.VERTEX,points:[{x:t,y:e}]})},curveVertex:function(t,e){h({type:r.CURVE,points:[{x:t,y:e}]})},bezierVertex:function(t,e,n,i,s,o){h({type:r.BEZIER,points:[{x:t,y:e},{x:n,y:i},{x:s,y:o}]})},bezier:function(t,e,n,i,s,r,o,c){beginShape(),vertex(t,e),bezierVertex(n,i,s,r,o,c),endShape()},curve:function(t,e,n,i,s,r,o,c){beginShape(),vertex(t,e),vertex(n,i),vertex(s,r),curveVertex(o,c),endShape()},bezierPoint:function(t,e,n,i,s){let r=1-s;return r*r*r*t+3*r*r*s*e+3*r*s*s*n+s*s*s*i},bezierTangent:function(t,e,n,i,s){let r=1-s;return 3*r*r*(e-t)+6*r*s*(n-e)+3*s*s*(i-n)},reloadFont:function(){s.ctx.font=s.settings.font.toString(),s.settings.genericTextMeasure=s.ctx.measureText("0"),s.settings.textHeight=s.settings.genericTextMeasure.fontBoundingBoxAscent+s.settings.genericTextMeasure.fontBoundingBoxDescent},textSize:function(t){s.settings.textSize=t,s.settings.font.size=t,s.reloadFont()},textAlign:function(t=r.LEFT,e=r.BASELINE){switch(t){default:Dark.error("Invalid x alignment type");break;case r.LEFT:s.ctx.textAlign="left",s.settings.alignX=r.LEFT;break;case r.RIGHT:s.ctx.textAlign="right",s.settings.alignX=r.RIGHT;break;case r.CENTER:s.ctx.textAlign="center",s.settings.alignX=r.CENTER}switch(e){default:Dark.error("Invalid y alignment type");break;case r.BASELINE:s.ctx.textBaseline="alphabetic",s.settings.alignY=r.BASELINE;break;case r.TOP:s.ctx.textBaseline="top",s.settings.alignY=r.TOP;break;case r.BOTTOM:s.ctx.textBaseline="bottom",s.settings.alignY=r.BOTTOM;break;case r.CENTER:s.ctx.textBaseline="middle",s.settings.alignY=r.CENTER}},textFont:function(t){"string"==typeof t&&(t=new s.objects.DFont(t)),t instanceof s.objects.DFont?(s.settings.font=t,s.settings.textSize=t.size,s.reloadFont()):Dark.error(t+" is not a DFont.")},createFont:function(t){return DFont.parse(t)},textStyle:function(t){switch(t){default:s.settings.font.weight="normal",s.settings.font.style="normal";break;case r.BOLD:s.settings.font.weight="bold";break;case r.ITALIC:s.settings.font.style="italic"}s.reloadFont()},textWidth:function(t){return s.ctx.measureText(t).width},textAscent:function(){return s.settings.genericTextMeasure.fontBoundingBoxAscent},textDescent:function(){return s.settings.genericTextMeasure.fontBoundingBoxDescent},textLeading:function(t){s.settings.lineGap=t},text:function(t,e,n){t.split("\n").forEach((t,i)=>{let r=i*(s.settings.textHeight+s.settings.lineGap);s.ctx.fillText(t,e,n+r),s.ctx.strokeText(t,e,n+r)})},get:function(...t){return 0==t.length?new DImage(s.ctx.getImageData(0,0,width,height),s.canvas):4==t.length?new DImage(s.ctx.getImageData(t[0],t[1],t[2],t[3]),s.canvas):void Dark.error(Error("get requires 0 or 4 parameters, not "+t.length))},set:function(t,e,n){s.ctx.save(),s.ctx.fillStyle=g(n),s.ctx.fillRect(t,e,1,1),s.ctx.restore()},image:function(t,e,n,i,o){switch(s.ctx.save(),s.settings.imageMode==r.CENTER&&s.ctx.translate(-i/2,-o/2),arguments.length){default:Dark.error(Error("image requires 3 to 5 parameters, not "+arguments.length));break;case 3:s.ctx.drawImage(t.canvas,e,n);break;case 4:s.ctx.drawImage(t.canvas,e,n,i,i);break;case 5:s.ctx.drawImage(t.canvas,e,n,i,o)}s.ctx.restore()},min:(t,e)=>t<e?t:e,max:(t,e)=>t>e?t:e,log10:t=>Math.log10(t),log2:t=>Math.log2(t),log:t=>Math.log(t),logBase:(t,e)=>Math.log(t)/Math.log(e),mag:(t,e)=>Math.sqrt(t*t+e*e),norm:(t,e,n)=>(t-e)/(n-e),constrain:(t,e,n)=>Math.min(Math.max(t,e),n),between:(t,e,n)=>t<=n&&t>=e,exceeds:(t,e,n)=>t>n||t<e,lerp:(t,e,n)=>(e-t)*n+t,map:(t,e,n,i,s)=>i+(s-i)/(n-e)*(value-e),sq:t=>t*t,cb:t=>t*t*t,pow:(t,e)=>t**e,root:(t,e)=>t**(1/e),sqrt:t=>Math.sqrt(t),cbrt:t=>Math.cbrt(t),exp:t=>E**t,floor:t=>Math.floor(t),round:t=>Math.round(t),ceil:t=>Math.ceil(t),trunc:t=>Math.trunc(t),deci:t=>t-Math.trunc(t),abs:t=>t<0?-t:t,sign:t=>Math.sign(t),bsign:t=>t<0?-1:1,degrees:t=>180*t/r.PI,radians:t=>t*r.PI/180,millennium:()=>Math.floor(new Date().getFullYear()/1e3),century:()=>Math.floor(new Date().getFullYear()/100),decade:()=>Math.floor(new Date().getFullYear()/10),year:()=>new Date().getFullYear(),month:()=>new Date().getMonth(),day:()=>new Date().getDate(),hour:()=>new Date().getHours(),minute:()=>new Date().getMinutes(),second:()=>new Date().getSeconds(),millis:()=>Math.floor(performance.now()),micro:()=>Math.floor(1e3*performance.now()%1e3),nano:()=>Math.floor(1e6*performance.now()%1e3),today:()=>DAYS[new Date().getDay()],timezone:()=>-new Date().getTimezoneOffset()/60,sin:t=>Math.sin(u(t)),cos:t=>Math.cos(u(t)),tan:t=>Math.tan(u(t)),csc:t=>1/Math.sin(u(t)),sec:t=>1/Math.cos(u(t)),cot:t=>1/Math.tan(u(t)),atan2(t,e){var n;return n=Math.atan2(t,e),s.settings.angleMode==r.DEGREES?180*n/r.PI:n},asin:t=>Math.asin(u(t)),acos:t=>Math.acos(u(t)),atan:t=>Math.atan(u(t)),acsc:t=>Math.asin(1/u(t)),asec:t=>Math.acos(1/u(t)),acot:t=>Math.atan(1/u(t)),sinh:t=>Math.sinh(u(t)),cosh:t=>Math.cosh(u(t)),tanh:t=>Math.tanh(u(t)),csch:t=>1/Math.sinh(u(t)),sech:t=>1/Math.cosh(u(t)),coth:t=>1/Math.tanh(u(t)),asinh:t=>Math.asinh(u(t)),acosh:t=>Math.acosh(u(t)),atanh:t=>Math.atanh(u(t)),acsch:t=>Math.asinh(1/u(t)),asech:t=>Math.acosh(1/u(t)),acoth:t=>Math.atanh(1/u(t)),now:()=>performance.now(),reciprocal:t=>1/t,trim:t=>t.trim()}),s.raf=function(t){let r,o,c=!1;i<performance.now()&&i>n?(r=o=i-n,c=!0):(r=t-e,o=t-n),s.isMain&&Dark.globallyUpdateVariables(s),(r>s.settings.frameStep-o/2&&s.settings.looping||c)&&(s.dt=r/1e3,s.fps=1e3/r,s.frameCount=++s.frameCount,s.draw(),e=performance.now()),n=performance.now(),requestAnimationFrame(s.raf)},s.dummy||(requestAnimationFrame(s.raf),s.frameRate(60),s.smooth(),s.ellipseMode(r.CENTER),s.rectMode(r.CORNER),s.imageMode(r.CORNER),s.angleMode(r.DEGREES),s.strokeCap(r.FLAT),s.strokeJoin(r.MITER),s.textAlign(r.LEFT,r.BASELINE),s.curveTightness(2),s.fill(255),s.stroke(0),s.strokeWeight(1),s.textFont("12px Arial"),s.textLeading(5),document.addEventListener("keydown",function(t){t.preventDefault(),s.keyIsPressed=!0,s.key=t.key,s.keyCode=t.keyCode,s.keyPressed()}),document.addEventListener("keyup",function(t){t.preventDefault(),s.keyIsPressed=!1,s.key=void 0,s.keyCode=void 0,s.keyReleased()}),document.addEventListener("keypress",function(t){t.preventDefault(),s.keyTyped()}),window.addEventListener("resize",function(t){t.preventDefault(),s.pageResized()}),document.addEventListener("visibilitychange",function(){"hidden"==document.visibilityState&&(i=performance.now())}),s.mouse=s.objects.DVector.zero2D(),s.pmouse=s.objects.DVector.zero2D(),s.settings.cursor="auto",s.settings.looping=!0)};Dark.instances=[],Dark.empties=["draw","keyPressed","keyReleased","keyTyped","mousePressed","mouseReleased","mouseMoved","mouseScrolled","mouseIn","mouseOut","mouseDoubleClicked","pageResized"],Dark.constants={DAYS:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],PI:Math.PI,HALF_PI:Math.PI/2,QUARTER_PI:Math.PI/4,E:Math.E,PHI:Math.PHI,TAU:2*Math.PI,ROUND:0,FLAT:1,DEGREES:2,RADIANS:3,VERTEX:4,CURVE:5,SMOOTH:6,BEZIER:7,CLOSE:8,OPEN:9,CENTER:10,CORNER:11,BOLD:12,ITALIC:13,NORMAL:14,BEVEL:15,MITER:16,SQUARE:17,LEFT:18,RIGHT:19,BASELINE:20,TOP:21,BOTTOM:22,GET:23,SET:24},Dark.special={16:"shift",10:"enter",8:"delete",32:"space",18:"option",17:"control",157:"command",38:"up",40:"down",37:"left",39:"right",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",20:"capslock",190:"period",188:"comma",191:"slash",220:"backslash",48:"zero",49:"one",50:"two",51:"three",52:"four",53:"five",54:"six",55:"seven",56:"eight",57:"nine",189:"minus",187:"equals",219:"left_bracket",221:"right_bracket",222:"single_quote",186:"semicolon"},Dark.ignoreGlobal=["empties","raf","vertices","transforms","settings","isMain","defaultCanvas","canvas","ctx"],Dark.variables={width:innerWidth,height:innerHeight,dt:0,frameCount:0,fps:60,key:void 0,keyCode:void 0,keyIsPressed:!1,mouseIsPressed:!1,mouseIsInside:!1,mouseX:0,mouseY:0,pmouseX:0,pmouseY:0,mouse:void 0,pmouse:void 0,mouseButton:void 0},Dark.mouseMap=["left","middle","right","back","forward"],Dark.changeable={},Dark.changeable.errorCount=0,Dark.maxErrorCount=50,Dark.maxTransforms=1e3,Dark.defaultContextSettings={willReadFrequently:!0},Dark.copy=function(t){if("object"!=typeof t&&"function"!=typeof t)return Dark.warn('"'+t+'" is not an object!'),t;{let e={};for(let n in t)e[n]=t[n];return"function"==typeof t&&0==Object.keys(e).length?t:e}},Dark.format=function(t){return"object"==typeof Dark.copy(t)&&("object"==typeof t||"function"==typeof t)?JSON.stringify(Dark.copy(t),null,"    "):t+""},Dark.doError=function(t,e){Dark.changeable.errorCount==Dark.maxErrorCount?console.warn("Too many warnings and errors have been made, the rest will not display."):Dark.changeable.errorCount<Dark.maxErrorCount&&console[t](e),Dark.changeable.errorCount++},Dark.warn=function(t){Dark.doError("warn",t)},Dark.error=function(t){Dark.doError("error",t)},Dark.observe=function(t,e,n){3==arguments.length&&e!=Dark.constants.GET&&e!=Dark.constants.SET&&Dark.error(Error("Invalid type, must be either GET or SET")),t=new Proxy(t,{get:function(t,i){return e==Dark.constants.GET&&n(i),t[i]},set:function(t,i,s){e==Dark.constants.SET&&n(i,s),t[i]=s}})};var a={b:3};Dark.observe(a,Dark.constants.SET,function(){}),a.b=5,Dark.observe(a),Dark.setMain=function(t){t instanceof Dark?(Dark.main&&(Dark.main.isMain=!1),Dark.main=t,t.isMain=!0):Dark.error(t+" is not an instance of Dark")},Dark.getMain=function(){return Dark.main},Dark.globallyUpdateVariables=function(t){for(let e in Dark.empties.forEach(function(e){window[e]&&(t[e]=window[e])}),t)if(!Dark.ignoreGlobal.includes(e)&&!Dark.empties.includes(e)){if("object"==typeof t[e])for(let n in t[e])window[n]=t[e][n];else window[e]=t[e]}},Dark.objects=function(){let t=function(t,e,n){3==arguments.length?(this.x=t,this.y=e,this.z=n,this.is2D=!1):2==arguments.length?(this.x=t,this.y=e,this.is2D=!0):Dark.error(Error("DVector requires 2 or 3 parameters, not "+arguments.length))};t.create=function(e,n,i){return new t(e,n,i)},t.zero2D=function(){return new t(0,0)},t.prototype.zero2D=function(){[this.x,this.y]=[0,0],this.z=void 0,this.is2D=!0},t.zero3D=function(){return new t(0,0,0)},t.prototype.zero3D=function(){[this.x,this.y,this.z]=[0,0,0]},t.add=function(e,n){return n instanceof t?e.is2D?new t(e.x+n.x,e.y+n.y):new t(e.x+n.x,e.y+n.y,e.z+n.z):e.is2D?new t(e.x+n,e.y+n):new t(e.x+n,e.y+n,e.z+n)},t.prototype.add=function(e){e instanceof t?(this.x+=e.x,this.y+=e.y,this.z+=e.z):(this.x+=e,this.y+=e,this.z+=e)},t.sub=function(e,n){return n instanceof t?e.is2D?new t(e.x-n.x,e.y-n.y):new t(e.x-n.x,e.y-n.y,e.z-n.z):e.is2D?new t(e.x-n,e.y-n):new t(e.x-n,e.y-n,e.z-n)},t.prototype.sub=function(e){e instanceof t?(this.x-=e.x,this.y-=e.y,this.z-=e.z):(this.x-=e,this.y-=e,this.z-=e)},t.mult=function(e,n){return n instanceof t?e.is2D?new t(e.x*n.x,e.y*n.y):new t(e.x*n.x,e.y*n.y,e.z*n.z):e.is2D?new t(e.x*n,e.y*n):new t(e.x*n,e.y*n,e.z*n)},t.prototype.mult=function(e){e instanceof t?(this.x*=e.x,this.y*=e.y,this.z*=e.z):(this.x*=e,this.y*=e,this.z*=e)},t.div=function(e,n){return n instanceof t?e.is2D?new t(e.x/n.x,e.y/n.y):new t(e.x/n.x,e.y/n.y,e.z/n.z):e.is2D?new t(e.x/n,e.y/n):new t(e.x/n,e.y/n,e.z/n)},t.prototype.div=function(e){e instanceof t?(this.x/=e.x,this.y/=e.y,this.z/=e.z):(this.x/=e,this.y/=e,this.z/=e)},t.pow=function(e,n){return n instanceof t?new t(e.x**n.x,e.y**n.y,e.z**n.z):new t(e.x**n,e.y**n,e.z**n)},t.prototype.pow=function(e){e instanceof t?(this.x**=e.x,this.y**=e.y,this.z**=e.z):(this.x**=e,this.y**=e,this.z**=e)},t.mag=function(t){return t.mag()},t.prototype.mag=function(){return this.is2D?Math.sqrt(this.x*this.x+this.y*this.y):Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},t.magSq=function(t){return t.magSq()},t.prototype.magSq=function(){return this.is2D?this.x*this.x+this.y*this.y:this.x*this.x+this.y*this.y+this.z*this.z},t.normalize=function(e){let n=e.mag();if(0!=n)return t.div(e,n)},t.prototype.normalize=function(){let t=this.mag();0!=t&&this.div(t)},t.cross=function(e,n){return new t(e.y*n.z-n.y*e.z,e.z*n.x-n.z*e.x,e.x*n.y-n.x*e.y)},t.prototype.cross=function(t){return this.cross(t)},t.dot=function(t,e){return"number"==typeof e?t.is2D?t.x*e+t.y*e:t.x*e+t.y*e+t.z*e:t.is2D&&e.is2D?t.x*e.x+t.y*e.y:t.is2D||e.is2D?void Dark.error(Error("Cannot take the dot product of a 2D and 3D vector")):t.x*e.x+t.y*e.y+t.z*e.z},t.prototype.dot=function(e){return t.dot(this,e)},t.flip=function(t){return new Vector(-t.x,-t.y,-t.z)},t.prototype.flip=function(){this.x=-this.x,this.y=-this.y,this.z=-this.z},t.limit=function(t,e){return t.mag()>e&&t.mult(e/t.mag()),t},t.prototype.limit=function(){this.mag()>max&&this.mult(max/this.mag())},t.lerp=function(e,n,i){return new t(Dark.utils.lerp(e.x,n.x,i),Dark.utils.lerp(e.y,n.y,i),Dark.utils.lerp(e.z,n.z,i))},t.prototype.lerp=function(e,n){return t.lerp(this,e,n)},t.dist=function(t,e){let n,i,s=0;return t.is2D&&e.is2D?(n=e.x-t.x,i=e.y-t.y):t.is2D||e.is2D?Dark.error(Error("Cannot find the distance between a 2D and 3D DVector")):(n=e.x-t.x,i=e.y-t.y,s=e.z-t.z),Math.sqrt(n*n+i*i+s*s)},t.prototype.dist=function(e){return t.dist(this,e)},t.get=function(t){return t.get()},t.prototype.get=function(){return new t(this.x,this.y,this.z)},t.set=function(t,e){[t.x,t.y,t.z]=[e.x,e.y,e.z]},t.prototype.set=function(t){[this.x,this.y,this.z]=[t.x,t.y,t.z]},t.toArray=function(t){return t.toArray()},t.prototype.toArray=function(){return this.is2D?[this.x,this.y]:[this.x,this.y,this.z]},t.fromArray=function(e){return t.create.apply(null,e)},t.prototype.fromArray=function(t){switch(t.length){default:Dark.error(Error("DVector.fromArray takes in an array of length 2 or 3, not "+t.length));break;case 2:[this.x,this.y]=t,this.z=void 0,this.is2D=!0;break;case 3:[this.x,this.y,this.z]=t,this.is2D=!1}},t.prototype.toString=function(){return this.is2D?"["+this.x+", "+this.y+"]":"["+this.x+", "+this.y+", "+this.z+"]"};let e=function(t){this.style="normal",this.variant="normal",this.weight="normal",this.size=16,this.family="Arial";let n=t.split(" ");for(let i in n){let s=n[i];switch(s){case"normal":break;case"italic":this.style="italic";break;case"bold":this.weight="bold"}if("italic"==s)this.style="italic";else if("small-caps"==s)this.variant="small-caps";else if(e.weights.includes(s))this.weight=s;else if("normal"!==s){let r=parseInt(s);isNaN(r)?this.family=s:this.size=r}}};e.parse=function(t){return new e(t)},e.prototype.toString=function(){return this.style+" "+this.weight+" "+this.variant+" "+this.size+"px "+this.family},e.weights=["bold","bolder","lighter","100","200","300","400","500","600","700","800","900"];let n=function(t,e){this.width=t.width,this.height=t.height,this.imageData=t,this.source=e,this.canvas=new OffscreenCanvas(this.width,this.height),this.ctx=this.canvas.getContext("2d",Dark.defaultContextSettings),this.ctx.putImageData(t,0,0)};n.get=function(t,...e){return t.get.apply(null,e)},n.prototype.get=function(...t){return 0==t.length?this.copy():4==t.length?new n(this.ctx.getImageData(t[0],t[1],t[2],t[3]),this.source):void Dark.error(Error("DImage.get requires 0 or 4 parameters, not "+t.length))},n.set=function(t,...e){t.set.apply(null,e)},n.prototype.set=function(t,e,n){let i=(t+e*this.width)*4;this.imageData.data[i]=Dark.utils.red(n),this.imageData.data[i+1]=Dark.utils.green(n),this.imageData.data[i+2]=Dark.utils.blue(n),this.imageData.data[i+3]=Dark.utils.alpha(n)},n.copy=function(t){return t.copy()},n.prototype.copy=function(){return new n(this.imageData,this.source)};let i=function(t,e,n=0){t instanceof i?(this.width=t.width,this.height=t.height,this.mat=Array(this.height).fill(null).map(()=>Array(this.width).fill(0)),this.set(t)):Array.isArray(t)?(Array.isArray(t[0])?(this.width=t[0].length,this.height=t.length):(this.width=e,this.height=n),this.mat=Array(this.height).fill(null).map(()=>Array(this.width).fill(0)),this.set(t)):(this.width=t,this.height=e,this.mat=Array(e).fill(null).map(()=>Array(t).fill(n)))};return i.prototype.get=function(t,e){return this.mat[e][t]},i.set=function(t,e,n,i){t.set(e,n,i)},i.prototype.set=function(t,e,n){if(t instanceof i)for(let s=0;s<t.height;s++)for(let r=0;r<t.width;r++)this.mat[s][r]=t.mat[s][r];else if(Array.isArray(t)){if(Array.isArray(t[0]))for(let o=0;o<t.length;o++)for(let c=0;c<t[0].length;c++)this.mat[o][c]=t[o][c];else for(let l=0;l<this.width*this.height;l++){let u=l%this.width,h=Math.floor(l/this.width);this.mat[h][u]=t[l]}}else this.mat[e][t]=n},i.dot=function(t,e,n,i){if(t.width==e.height){let s=0;for(let r=0;r<t.width;r++)s+=t.get(r,n)*e.get(i,r);return s}Dark.error(Error("Can only take the dot product of two DMatrices  with equal width and height"))},i.prototype.dot=function(t){return i.dot(this,t)},i.identity=function(t){let e=new i(t,t);for(let n=0;n<t;n++)e.set(n,n,1);return e},i.prototype.identity=function(){this.width==this.height?this.mat=i.identity(this.width).mat:Dark.error(Error("Only DMatrices with square dimensions have identity DMatrices"))},i.add=function(t,e){if("number"==typeof e){let n=new i(t.width,t.height);for(let s=0;s<n.height;s++)for(let r=0;r<n.width;r++)n.set(s,r,t.get(r,s)+e);return n}if(t.width==e.width&&t.height==e.height){let o=new i(t.width,t.height);for(let c=0;c<o.height;c++)for(let l=0;l<o.width;l++)o.set(c,l,t.get(l,c)+e.get(l,c));return o}Dark.error(Error("Cannot add two DMatrices with different dimensions"))},i.prototype.add=function(t){this.set(i.add(this,t))},i.sub=function(t,e){if("number"==typeof e){let n=new i(t.width,t.height);for(let s=0;s<n.height;s++)for(let r=0;r<n.width;r++)n.set(s,r,t.get(r,s)-e);return n}if(t.width==e.width&&t.height==e.height){let o=new i(t.width,t.height);for(let c=0;c<o.height;c++)for(let l=0;l<o.width;l++)o.set(c,l,t.get(l,c)-e.get(l,c));return o}Dark.error(Error("Cannot subtract two DMatrices with different dimensions"))},i.prototype.sub=function(t){this.set(i.sub(this,t))},i.mult=function(t,e){if("number"==typeof e){let n=new i(t.width,t.height);for(let s=0;s<n.height;s++)for(let r=0;r<n.width;r++)n.set(s,r,t.get(r,s)*e);return n}if(t.width==e.height){let o=new i(e.width,t.height);for(let c=0;c<o.height;c++)for(let l=0;l<o.width;l++)o.set(l,c,i.dot(t,e,c,l));return o}Dark.error(Error("Can only multiply two DMatrices with equal width and height"))},i.prototype.mult=function(t){let e=i.mult(this,t);this.width=e.width,this.height=e.height,this.mat=e.mat},i.prototype.copy=function(){return new i([...this.mat])},i.prototype.toArray=function(){return[...this.mat]},i.prototype.toString=function(){let t="";for(let e in this.mat){for(let n in this.mat[e])t+=this.mat[e][n]+" ";t=t.replace(/ $/,"\n")}return t},{DVector:t,DFont:e,DImage:n,DMatrix:i}}(),Dark.utils=new Dark(!0),Dark.setMain(new Dark),Dark.globallyUpdateVariables(Dark.main),Object.freeze(Dark);
