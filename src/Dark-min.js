/*

  All code by @99TheDark unless noted. (See CREDITS.md)
  
  Minified with Toptal.

*/

if(!window.Dark){var t=function(e=!1){this.darkObject=!0;let n=performance.now(),i=performance.now(),r=-1,s=this,o=t.constants;for(let a in t.instances.push(s),s.settings={},s.transforms=[],s.saves=[],s.styles=[],s.vertices=[],s.vertexCache=[],s.objects=t.objects,s.copy=t.copy,s.format=t.format,o=s.constants=t.constants,s.dummy=e,t.variables)s[a]=t.variables[a];s.isMain=!1,s.canvas=new OffscreenCanvas(innerWidth,innerHeight),s.ctx=s.canvas.getContext("2d",t.defaultContextSettings),t.empties.forEach(t=>s[t]=()=>{});var l=function(t){return s.settings.angleMode==o.DEGREES?t*o.PI/180:t},c=function(t){s.vertices.push(t),t.points.forEach(t=>s.vertexCache.push(new DVector(t.x,t.y)))},u=function(){s.canvas.addEventListener("click",function(t){t.preventDefault(),s.mouseClicked()}),s.canvas.addEventListener("mousedown",function(e){e.preventDefault(),s.mouseIsPressed=!0,s.mouseButton=t.mouseMap[e.button],s.mousePressed()}),s.canvas.addEventListener("mouseup",function(t){t.preventDefault(),s.mouseButton=void 0,s.mouseIsPressed=!1,s.mouseReleased()}),s.canvas.addEventListener("mouseenter",function(t){t.preventDefault(),s.mouseIsInside=!0,s.mouseIn()}),s.canvas.addEventListener("mouseleave",function(t){s.mouseIsInside=!1,t.preventDefault(),s.mouseOut()}),s.canvas.addEventListener("mousemove",function(t){t.preventDefault();let e=t.target.getBoundingClientRect();s.pmouseX=s.pmouse.x=s.mouseX,s.pmouseY=s.pmouse.y=s.mouseY,s.mouseX=s.mouse.x=s.constrain(s.round(t.pageX-e.x),0,width),s.mouseY=s.mouse.y=s.constrain(s.round(t.pageY-e.y),0,height),s.mouseMoved()}),s.canvas.addEventListener("wheel",function(t){t.preventDefault(),s.mouseScroll=s.objects.DVector.create(t.deltaX,t.deltaY,t.deltaZ),s.mouseScrolled()}),s.canvas.addEventListener("dblclick",function(t){t.preventDefault(),s.mouseDoubleClicked()})},h=function(t){return"rgba("+s.red(t)+", "+s.green(t)+", "+s.blue(t)+", "+s.alpha(t)/255+")"};!function(t){for(let e in t)s[e]=t[e]}({size:function(e=innerWidth,n=innerHeight){if("number"==typeof e&&"number"==typeof n&&e>0&&n>0){let i=s.copy(s.ctx);[s.width,s.height]=[s.canvas.width,s.canvas.height]=[e,n];let r=["canvas","width","height"];for(let o in s.ctx){let a=i[o];"function"==typeof a||r.includes(o)||(s.ctx[o]=a)}t.globallyUpdateVariables(s)}},setCanvas:function(e){if(e instanceof HTMLCanvasElement){s.canvas=e,s.width=e.width,s.height=e.height;let n=copy(s.ctx);for(let i in s.ctx=e.getContext("2d",t.defaultContextSettings),s.ctx){let r=n[i];"canvas"!==i&&"function"!=typeof r&&(s.ctx[i]=r)}s.canvas.style.cursor=s.settings.cursor,s.canvas.tabIndex="1",u()}},getCanvas:function(){return s.canvas},getContext:function(){return s.ctx},setTitle:function(t){document.title=t},dist:function(...t){let e,n;return t.length=6,e=t[2]-t[0],n=t[3]-t[1],s.sqrt(e*e+n*n+0)},gamma:function(t){return s.sqrt(o.TAU/t)*((t+1/(12*t+1/(10*t)))/E)**t},factorial:function(t){return Number.isInteger(t)?intFactorial(t):gamma(t+1)},intFactorial:function(t){let e=t=s.floor(t);for(;--t>1;)e*=t;return e},choose:function(t,e){return intFactorial(t)/(intFactorial(t-e)*intFactorial(e))},random:function(...t){switch(t.length){default:return Math.random()*(t[1]-t[0])+t[0];case 0:return Math.random();case 1:return Math.random()*t[0]}},cursor:function(t="default"){s.settings.cursor=t,s.canvas.style.cursor=t},noCursor:function(){s.settings.cursor="none",s.canvas.style.cursor="none"},loop:function(){s.settings.looping=!0},noLoop:function(){s.settings.looping=!1},frameRate:function(t){s.settings.frameStep=1e3/t},enableContextMenu:function(){s.settings.contextMenu=!0,s.canvas.oncontextmenu=!0},disableContextMenu:function(){s.settings.contextMenu=!1,s.canvas.oncontextmenu=!1},color:function(t,e,n,i){let r=arguments.length;if(0==r)return -1;if(1==r||2==r){if(!(t<=255)||!(t>=0))return t;1==r?n=e=t:(i=e,e=t,n=t)}return i||(i=255),t=s.constrain(t,0,255),e=s.constrain(e,0,255),n=s.constrain(n,0,255),((i=s.constrain(i,0,255))<<24)+(t<<16)+(e<<8)+n},randomColor:function(){return color(255*Math.random(),255*Math.random(),255*Math.random())},red:t=>t>>16&255,green:t=>t>>8&255,blue:t=>255&t,alpha:t=>t>>24&255,lerpColor:function(t,e,n){return color(s.lerp(s.red(t),s.red(e),n),s.lerp(s.green(t),s.green(e),n),s.lerp(s.blue(t),s.blue(e),n),s.lerp(s.alpha(t),s.alpha(e),n))},fill:function(...t){let e=s.settings.fill=s.color.apply(null,t);s.ctx.fillStyle=h(e)},noFill:function(){s.settings.fill=0,s.ctx.fillStyle="rgba(0, 0, 0, 0)"},stroke:function(...t){let e=s.settings.stroke=s.color.apply(null,t);s.ctx.strokeStyle=h(e)},noStroke:function(){s.settings.stroke=0,s.ctx.strokeStyle="rgba(0, 0, 0, 0)"},background:function(...t){s.ctx.save(),s.ctx.resetTransform();let e=s.color.apply(null,t);s.ctx.fillStyle=h(e),s.ctx.clearRect(0,0,s.width,s.height),s.ctx.fillRect(0,0,s.width,s.height),s.ctx.restore()},clear:function(){s.ctx.save(),s.ctx.resetTransform(),s.ctx.clearRect(0,0,s.width,s.height),s.ctx.restore()},strokeCap:function(e){switch(e){default:t.error(Error("Invalid strokeCap type"));break;case o.FLAT:s.ctx.lineCap="butt",s.settings.strokeCap=o.FLAT;break;case o.ROUND:s.ctx.lineCap="round",s.settings.strokeCap=o.ROUND;break;case o.SQUARE:s.ctx.lineCap="square",s.settings.strokeCap=o.SQUARE}},strokeJoin:function(e=o.MITER){switch(e){default:t.error(Error("Invalid strokeJoin type"));break;case o.MITER:s.ctx.lineJoin="miter",s.settings.strokeJoin=o.MITER;break;case o.BEVEL:s.ctx.lineJoin="bevel",s.settings.strokeJoin=o.BEVEL;break;case o.ROUND:s.ctx.lineJoin="round",s.settings.strokeJoin=o.ROUND}},strokeWeight:function(t){s.settings.strokeWeight=t,s.ctx.lineWidth=t},smooth:function(){s.settings.smoothing=!0,s.ctx.imageSmoothingEnabled=!0,s.ctx.imageSmoothingQuality="high"},noSmooth:function(){s.settings.smoothing=!0,s.ctx.imageSmoothingEnabled=!1,s.ctx.imageSmoothingQuality="low"},angleMode:function(e){switch(e){default:t.error(Error("Invalid angleMode type"));break;case o.DEGREES:s.settings.angleMode=o.DEGREES;break;case o.RADIANS:s.settings.angleMode=o.RADIANS}},ellipseMode:function(t=o.CENTER){s.settings.ellipseMode=t},rectMode:function(t=o.CORNER){s.settings.rectMode=t},imageMode:function(t=o.CORNER){s.settings.imageMode=t},curveTightness:function(t=0){s.settings.curveTightness=t},pushMatrix:function(){s.transforms.length>s.maxTransforms?t.error(Error("Maximum matrix stack size reached, pushMatrix() called "+s.maxTransforms+" times.")):s.transforms.push(s.ctx.getTransform())},popMatrix:function(){let e=s.transforms.pop();e?s.ctx.setTransform(e):t.error(Error("No more transforms to restore in popMatrix()"))},resetMatrix:function(){s.transforms.length=0,s.ctx.resetTransform()},push:function(){s.transforms.length>s.maxTransforms?t.error(Error("Maximum matrix stack size reached, push() called "+s.maxTransforms+" times.")):(s.ctx.save(),s.saves.push(Object.assign({},s.settings)))},pop:function(){let e=s.saves.pop();e?(s.ctx.restore(),Object.assign(s.settings,e)):t.error(Error("No more saves to restore in pop()"))},reset:function(){s.saves.length=0,s.settings=Object.assign({},s.defaultSettings),s.ctx.reset()},translate:function(t,e){s.ctx.translate(t,e)},rotate:function(t){s.ctx.rotate(l(t))},scale:function(t,e){arguments.length<2?s.ctx.scale(t,t):s.ctx.scale(t,e)},skew:function(t,e=0){let n=s.ctx.getTransform();n.b=.01*e,n.c=.01*t,s.ctx.setTransform(n)},rect:function(e,n,i,r,a,l,c,u){switch(i=Math.abs(i),r=Math.abs(r),s.ctx.beginPath(),s.ctx.save(),s.settings.rectMode==o.CENTER&&s.ctx.translate(-i/2,-r/2),arguments.length){default:t.error(Error("rect takes in 4, 5 or 8 parameters, not "+arguments.length));break;case 4:s.ctx.rect(e,n,i,r);break;case 5:s.ctx.roundRect(e,n,i,r,a);break;case 6:s.ctx.roundRect(e,n,i,r,[a,l,c,u])}s.ctx.fill(),s.ctx.stroke(),s.ctx.restore()},ellipse:function(t,e,n,i){n=Math.abs(n),i=Math.abs(i),s.ctx.beginPath(),s.ctx.save(),s.settings.ellipseMode==o.CORNER&&s.ctx.translate(n/2,i/2),s.ctx.beginPath(),s.ctx.ellipse(t,e,n/2,i/2,0,0,o.TAU,!1),s.ctx.fill(),s.ctx.stroke(),s.ctx.restore()},arc:function(t,e,n,i,r,a){s.ctx.save(),s.settings.ellipseMode==o.CORNER&&s.ctx.translate(n/2,i/2),s.ctx.beginPath(),s.ctx.ellipse(t,e,n/2,i/2,0,r,a,!1),s.ctx.fill(),s.ctx.stroke(),s.ctx.restore()},line:function(t,e,n,i){s.ctx.beginPath(),s.ctx.moveTo(t,e),s.ctx.lineTo(n,i),s.ctx.stroke()},point:function(t,e){s.ctx.save(),s.ctx.beginPath(),s.ctx.fillStyle=h(s.settings.stroke),s.ctx.arc(t,e,s.settings.strokeWeight/2,0,o.TAU),s.ctx.fill(),s.ctx.restore()},circle:function(t,e,n){s.ctx.save(),s.settings.ellipseMode==o.CORNER&&s.ctx.translate(n,n),s.ctx.beginPath(),s.ctx.arc(t,e,n,0,o.TAU),s.ctx.fill(),s.ctx.stroke(),s.ctx.restore()},square:function(t,e,n){rect(t,e,n,n)},triangle:function(t,e,n,i,r,o){s.ctx.beginPath(),s.ctx.moveTo(t,e),s.ctx.lineTo(n,i),s.ctx.lineTo(r,o),s.ctx.closePath(),s.ctx.fill(),s.ctx.stroke()},quad:function(t,e,n,i,r,o,a,l){s.ctx.beginPath(),s.ctx.moveTo(t,e),s.ctx.lineTo(n,i),s.ctx.lineTo(r,o),s.ctx.lineTo(a,l),s.ctx.closePath(),s.ctx.fill(),s.ctx.stroke()},beginShape:function(){s.vertices.length=0,s.vertexCache.length=0},endShape:function(t=o.OPEN){s.vertices.length<2||s.vertices[0].type==o.BEZIER||(s.ctx.beginPath(),s.vertices.forEach(function(t,e){if(0==e)s.ctx.moveTo(t.points[0].x,t.points[0].y);else switch(t.type){case o.VERTEX:let n=t.points[0];s.ctx.lineTo(n.x,n.y);break;case o.CURVE:let i=(s.settings.curveTightness-1)/6,r=s.vertexCache[e-3],a=s.vertexCache[e-2],l=s.vertexCache[e-1],c=s.vertexCache[e];if(2==e)break;0==e?s.ctx.moveTo(c.x,c.y):e<3?s.ctx.lineTo(c.x,c.y):(3==e&&s.ctx.lineTo(a.x,a.y),s.ctx.bezierCurveTo(l.x*i+a.x-r.x*i,l.y*i+a.y-r.y*i,-(c.x*i)+l.x+a.x*i,-(c.y*i)+l.y+a.y*i,l.x,l.y));break;case o.BEZIER:let u=t.points;s.ctx.bezierCurveTo(u[0].x,u[0].y,u[1].x,u[1].y,u[2].x,u[2].y);case o.SMOOTH:}}),t==o.CLOSE&&s.ctx.closePath(),s.ctx.fill(),s.ctx.stroke())},vertex:function(t,e){c({type:o.VERTEX,points:[{x:t,y:e}]})},curveVertex:function(t,e){c({type:o.CURVE,points:[{x:t,y:e}]})},bezierVertex:function(t,e,n,i,r,s){c({type:o.BEZIER,points:[{x:t,y:e},{x:n,y:i},{x:r,y:s}]})},bezier:function(t,e,n,i,r,s,o,a){beginShape(),vertex(t,e),bezierVertex(n,i,r,s,o,a),endShape()},curve:function(t,e,n,i,r,s,o,a){beginShape(),vertex(t,e),vertex(n,i),vertex(r,s),curveVertex(o,a),endShape()},bezierPoint:function(t,e,n,i,r){let s=1-r;return s*s*s*t+3*s*s*r*e+3*s*r*r*n+r*r*r*i},curvePoint:function(t,e,n,i,r){return .5*(2*e+(n-t)*r+(2*t-5*e+4*n-i)*r*r+(3*e-3*n+i-t)*r*r*r)},curveTangent:function(t,e,n,i,r){return .5*(n-t+2*(2*t-5*e+4*n-i)*r+3*(3*e-3*n+i-t)*r*r)},bezierTangent:function(t,e,n,i,r){let s=1-r;return 3*s*s*(e-t)+6*s*r*(n-e)+3*r*r*(i-n)},reloadFont:function(){s.ctx.font=s.settings.font.toString(),s.settings.genericTextMeasure=s.ctx.measureText("0"),s.settings.textHeight=s.settings.genericTextMeasure.fontBoundingBoxAscent+s.settings.genericTextMeasure.fontBoundingBoxDescent},textSize:function(t){s.settings.textSize=t,s.settings.font.size=t,s.reloadFont()},textAlign:function(e,n){switch(0==arguments.length&&(e=o.LEFT,n=o.BASELINE),1==arguments.length&&e==o.CENTER&&(n=o.CENTER),e){default:t.error(Error("Invalid x alignment type"));break;case o.LEFT:s.ctx.textAlign="left",s.settings.alignX=o.LEFT;break;case o.RIGHT:s.ctx.textAlign="right",s.settings.alignX=o.RIGHT;break;case o.CENTER:s.ctx.textAlign="center",s.settings.alignX=o.CENTER}switch(n){default:t.error(Error("Invalid y alignment type"));break;case o.BASELINE:s.ctx.textBaseline="alphabetic",s.settings.alignY=o.BASELINE;break;case o.TOP:s.ctx.textBaseline="top",s.settings.alignY=o.TOP;break;case o.BOTTOM:s.ctx.textBaseline="bottom",s.settings.alignY=o.BOTTOM;break;case o.CENTER:s.ctx.textBaseline="middle",s.settings.alignY=o.CENTER}},textFont:function(e){"string"==typeof e&&(e=new s.objects.DFont(e)),e instanceof s.objects.DFont?(s.settings.font=e,s.settings.textSize=e.size,s.reloadFont()):t.error(e+" is not a DFont.")},createFont:function(t){return DFont.parse(t)},textStyle:function(t){switch(t){default:s.settings.font.weight="normal",s.settings.font.style="normal";break;case o.BOLD:s.settings.font.weight="bold";break;case o.ITALIC:s.settings.font.style="italic"}s.reloadFont()},textWidth:function(t){return s.ctx.measureText(t).width},textAscent:function(){return s.settings.genericTextMeasure.fontBoundingBoxAscent},textDescent:function(){return s.settings.genericTextMeasure.fontBoundingBoxDescent},textLeading:function(t){s.settings.lineGap=t},text:function(t,e,n){let i=t.split("\n"),r=s.settings.alignY==o.CENTER?(s.settings.textHeight+s.settings.lineGap)*i.length/2:0;i.forEach((t,i)=>{let o=i*(s.settings.textHeight+s.settings.lineGap)-r;s.ctx.fillText(t,e,n+o),s.ctx.strokeText(t,e,n+o)})},get:function(...e){return 0==e.length?new DImage(s.ctx.getImageData(0,0,s.width,s.height),s.canvas):4==e.length?new DImage(s.ctx.getImageData(e[0],e[1],e[2],e[3]),s.canvas):void t.error(Error("get requires 0 or 4 parameters, not "+e.length))},set:function(t,e,n){s.ctx.save(),s.ctx.fillStyle=h(n),s.ctx.fillRect(t,e,1,1),s.ctx.restore()},image:function(e,n,i,r,a){switch(s.ctx.save(),s.settings.imageMode==o.CENTER&&s.ctx.translate(-r/2,-a/2),e instanceof ImageData&&(e=new DImage(e)),arguments.length){default:t.error(Error("image requires 3 to 5 parameters, not "+arguments.length));break;case 3:if(!t.rectRect(n,i,e.width,e.height,0,0,s.width,s.height))break;s.ctx.drawImage(e.canvas,n,i);break;case 4:if(!t.rectRect(n,i,r,r,0,0,s.width,s.height))break;s.ctx.drawImage(e.canvas,n,i,r,r);break;case 5:if(!t.rectRect(n,i,r,a,0,0,s.width,s.height))break;s.ctx.drawImage(e.canvas,n,i,r,a)}s.ctx.restore()},filter:function(t,e){let n=new DImage(s.ctx.getImageData(0,0,s.width,s.height),s);n.filter(t,e),s.ctx.putImageData(n.imageData,0,0)},min:(t,e)=>t<e?t:e,max:(t,e)=>t>e?t:e,log10:t=>Math.log10(t),log2:t=>Math.log2(t),log:t=>Math.log(t),logBase:(t,e)=>Math.log(t)/Math.log(e),mag:(t,e)=>Math.sqrt(t*t+e*e),norm:(t,e,n)=>(t-e)/(n-e),constrain:(t,e,n)=>Math.min(Math.max(t,e),n),between:(t,e,n)=>t<=n&&t>=e,exceeds:(t,e,n)=>t>n||t<e,lerp:(t,e,n)=>(e-t)*n+t,map:(t,e,n,i,r)=>i+(r-i)/(n-e)*(value-e),sq:t=>t*t,cb:t=>t*t*t,pow:(t,e)=>t**e,root:(t,e)=>t**(1/e),sqrt:t=>Math.sqrt(t),cbrt:t=>Math.cbrt(t),exp:t=>E**t,floor:t=>Math.floor(t),round:t=>Math.round(t),ceil:t=>Math.ceil(t),trunc:t=>Math.trunc(t),deci:t=>t-Math.trunc(t),abs:t=>t<0?-t:t,sign:t=>Math.sign(t),bsign:t=>t<0?-1:1,degrees:t=>180*t/o.PI,radians:t=>t*o.PI/180,millennium:()=>Math.floor(new Date().getFullYear()/1e3),century:()=>Math.floor(new Date().getFullYear()/100),decade:()=>Math.floor(new Date().getFullYear()/10),year:()=>new Date().getFullYear(),month:()=>new Date().getMonth(),day:()=>new Date().getDate(),hour:()=>new Date().getHours(),minute:()=>new Date().getMinutes(),second:()=>new Date().getSeconds(),millis:()=>Math.floor(performance.now()),micro:()=>Math.floor(1e3*performance.now()%1e3),nano:()=>Math.floor(1e6*performance.now()%1e3),today:()=>DAYS[new Date().getDay()],timezone:()=>-new Date().getTimezoneOffset()/60,sin:t=>Math.sin(l(t)),cos:t=>Math.cos(l(t)),tan:t=>Math.tan(l(t)),csc:t=>1/Math.sin(l(t)),sec:t=>1/Math.cos(l(t)),cot:t=>1/Math.tan(l(t)),atan2(t,e){var n;return n=Math.atan2(t,e),s.settings.angleMode==o.DEGREES?180*n/o.PI:n},asin:t=>Math.asin(l(t)),acos:t=>Math.acos(l(t)),atan:t=>Math.atan(l(t)),acsc:t=>Math.asin(1/l(t)),asec:t=>Math.acos(1/l(t)),acot:t=>Math.atan(1/l(t)),sinh:t=>Math.sinh(l(t)),cosh:t=>Math.cosh(l(t)),tanh:t=>Math.tanh(l(t)),csch:t=>1/Math.sinh(l(t)),sech:t=>1/Math.cosh(l(t)),coth:t=>1/Math.tanh(l(t)),asinh:t=>Math.asinh(l(t)),acosh:t=>Math.acosh(l(t)),atanh:t=>Math.atanh(l(t)),acsch:t=>Math.asinh(1/l(t)),asech:t=>Math.acosh(1/l(t)),acoth:t=>Math.atanh(1/l(t)),now:()=>performance.now(),reciprocal:t=>1/t,trim:t=>t.trim()}),s.raf=function(e){let o=(e=performance.now())-n,a=e-i;i=performance.now();let l=o>s.settings.frameStep-a/2&&s.settings.looping;r<e&&r>i&&(o=a=e-r),l&&(n=e,s.draw(),s.dt=o/1e3,s.fps=1e3/o,s.frameCount=++s.frameCount),s.isMain&&t.globallyUpdateVariables(s),requestAnimationFrame(s.raf)},s.frameRate(60),s.smooth(),s.ellipseMode(o.CENTER),s.rectMode(o.CORNER),s.imageMode(o.CORNER),s.angleMode(o.DEGREES),s.strokeCap(o.ROUND),s.strokeJoin(o.MITER),s.textAlign(o.LEFT,o.BASELINE),s.curveTightness(2),s.fill(255),s.stroke(0),s.strokeWeight(1),s.textFont("12px Arial"),s.textLeading(5),s.defaultSettings=Object.assign({},s.settings),s.dummy||(requestAnimationFrame(s.raf),document.addEventListener("keydown",function(t){t.preventDefault(),s.keyIsPressed=!0,s.key=t.key,s.keyCode=t.keyCode,s.keyPressed()}),document.addEventListener("keyup",function(t){t.preventDefault(),s.keyIsPressed=!1,s.key=void 0,s.keyCode=void 0,s.keyReleased()}),document.addEventListener("keypress",function(t){t.preventDefault(),s.keyTyped()}),window.addEventListener("resize",function(t){t.preventDefault(),s.pageResized()}),document.addEventListener("visibilitychange",function(){"hidden"==document.visibilityState&&(s.keyIsPressed=!1,s.key=void 0,s.keyCode=void 0,s.mouseIsPressed=!1,s.mouseButton=void 0,s.mouseIsInside=!1,r=performance.now())}),s.mouse=s.objects.DVector.zero2D(),s.pmouse=s.objects.DVector.zero2D(),s.settings.cursor="auto",s.settings.looping=!0)};t.instances=[],t.empties=["draw","keyPressed","keyReleased","keyTyped","mouseClicked","mousePressed","mouseReleased","mouseMoved","mouseScrolled","mouseIn","mouseOut","mouseDoubleClicked","pageResized"],t.constants={DAYS:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],PI:Math.PI,HALF_PI:Math.PI/2,QUARTER_PI:Math.PI/4,E:Math.E,PHI:Math.PHI,TAU:2*Math.PI,ROUND:0,FLAT:1,DEGREES:2,RADIANS:3,VERTEX:4,CURVE:5,SMOOTH:6,BEZIER:7,CLOSE:8,OPEN:9,CENTER:10,CORNER:11,BOLD:12,ITALIC:13,NORMAL:14,BEVEL:15,MITER:16,SQUARE:17,LEFT:18,RIGHT:19,BASELINE:20,TOP:21,BOTTOM:22,GET:23,SET:24,PERLIN:25,SIMPLEX:26,WORLEY:27,VALUE:28,RANDOM:29,INVERT:30,OPAQUE:31,GRAY:32,ERODE:33,DILATE:34,THRESHOLD:35,POSTERIZE:36,BLUR:37,SHARPEN:38,SEPIA:39,OUTLINE:40,EMBOSS:41,EDGE:42,COTRAST:43,VIGNETTE:44,BRIGHTNESS:45,BLACK:46,WHITE:47,MEDIAN:48,BOX:49,TRANSPARENCY:50},t.filters=[t.constants.INVERT,t.constants.OPAQUE,t.constants.GRAY,t.constants.THRESHOLD,t.constants.POSTERIZE,t.constants.VIGNETTE,t.constants.BRIGHTNESS,t.constants.BLACK,t.constants.WHITE,t.constants.BOX,t.constants.TRANSPARENCY],t.special={16:"shift",10:"enter",8:"delete",32:"space",18:"option",17:"control",157:"command",38:"up",40:"down",37:"left",39:"right",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",20:"capslock",190:"period",188:"comma",191:"slash",220:"backslash",48:"zero",49:"one",50:"two",51:"three",52:"four",53:"five",54:"six",55:"seven",56:"eight",57:"nine",189:"minus",187:"equals",219:"left_bracket",221:"right_bracket",222:"single_quote",186:"semicolon"},t.cursors=["auto","default","none","context-menu","help","pointer","progress","wait","cell","crosshair","text","vertical-text","alias","copy","move","no-drop","not-allowed","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out"],t.ignoreGlobal=["empties","raf","vertices","transforms","settings","defaultSettings","isMain","canvas","ctx"],t.variables={width:innerWidth,height:innerHeight,dt:0,frameCount:0,fps:60,key:void 0,keyCode:void 0,keyIsPressed:!1,mouseIsPressed:!1,mouseIsInside:!1,mouseX:0,mouseY:0,pmouseX:0,pmouseY:0,mouse:void 0,pmouse:void 0,mouseButton:void 0},t.mouseMap=["left","middle","right","back","forward"],t.changeable={},t.darkObject=!0,t.changeable.errorCount=0,t.maxErrorCount=50,t.maxTransforms=1e3,t.defaultContextSettings={willReadFrequently:!0},t.url=new URL(location.href),t.copy=function(e){if("object"!=typeof e&&"function"!=typeof e)return t.warn('"'+e+'" is not an object!'),e;{let n={};for(let i in e)n[i]=e[i];return"function"==typeof e&&0==Object.keys(n).length?e:n}},t.format=function(e){return"object"==typeof t.copy(e)&&("object"==typeof e||"function"==typeof e)?JSON.stringify(t.copy(e),null,"    "):e+""},t.rectRect=function(t,e,n,i,r,s,o,a){return t+n>r&&t<r+o&&e+i>s&&e<s+a},t.doError=function(e,n){t.changeable.errorCount==t.maxErrorCount?console.warn("Too many warnings and errors have been made, the rest will not display."):t.changeable.errorCount<t.maxErrorCount&&console[e](n),t.changeable.errorCount++},t.warn=function(e){t.doError("warn",e)},t.error=function(e){t.doError("error",e)},t.observe=function(e,n,i){3==arguments.length&&n!=t.constants.GET&&n!=t.constants.SET&&t.error(Error("Invalid type, must be either GET or SET")),e=new Proxy(e,{get:function(e,r){return n==t.constants.GET&&i(r),e[r]},set:function(e,r,s){n==t.constants.SET&&i(r,s),e[r]=s}})},t.setMain=function(e){e instanceof t?(t.main&&(t.main.isMain=!1),t.main=e,e.isMain=!0):t.error(e+" is not an instance of Dark")},t.getMain=function(){return t.main},t.fileCacheKA={"/filters/global.vert":"# version 300 es\nprecision lowp float;\nin vec2 pos;\nout vec2 uv;\nvoid main() {\n uv = (pos + 1.0) * 0.5; // Vertex position = -1 to 1, UV = 0 to 1\n gl_Position = vec4(pos, 0.0, 1.0);\n}","/filters/invert.frag":"# version 300 es\nprecision lowp float;\nuniform sampler2D sampler;\nin vec2 uv;\nout vec4 color;\nvoid main() {\n vec4 tex = texture(sampler, uv);\n color = vec4(1.0 - tex.rgb, tex.a);\n}","/filters/opaque.frag":"# version 300 es\nprecision lowp float;\nuniform sampler2D sampler;\nin vec2 uv;\nout vec4 color;\nvoid main() {\n vec4 tex = texture(sampler, uv);\n color = vec4(tex.rgb, 1.0);\n}","/filters/grayscale.frag":"# version 300 es\nprecision lowp float;\nuniform sampler2D sampler;\nin vec2 uv;\nout vec4 color;\nvoid main() {\n vec4 tex = texture(sampler, uv);\n float luminance = 0.2126 * tex.r + 0.7152 * tex.g + 0.0722 * tex.b; // Based on how human eyes precieve\n color = vec4(vec3(luminance), tex.a);\n}","/filters/threshold.frag":"# version 300 es\nprecision lowp float;\nuniform sampler2D sampler;\nuniform float param;\nin vec2 uv;\nout vec4 color;\nvoid main() {\n vec4 tex = texture(sampler, uv);\n float luminance = 0.2126 * tex.r + 0.7152 * tex.g + 0.0722 * tex.b; // Same as grayscale\n if(luminance > param) {\n color = vec4(vec3(1.0), 1.0);\n } else {\n color = vec4(vec3(0.0), 1.0);\n }\n}","/filters/posterize.frag":"# version 300 es\nprecision lowp float;\nuniform sampler2D sampler;\nuniform float param;\nin vec2 uv;\nout vec4 color;\nfloat posterize(float val) {\n return floor(val * param + 0.5) / param;\n}\nvoid main() {\n vec4 tex = texture(sampler, uv);\n float red = posterize(tex.r);\n float green = posterize(tex.g);\n float blue = posterize(tex.b);\n \n color = vec4(red, green, blue, 1.0);\n}","/filters/black.frag":"# version 300 es\nprecision lowp float;\nuniform sampler2D sampler;\nuniform float param;\nin vec2 uv;\nout vec4 color;\nvoid main() {\n vec4 tex = texture(sampler, uv);\n float luminance = 0.2126 * tex.r + 0.7152 * tex.g + 0.0722 * tex.b; // Same as grayscale\n if(luminance <= param) {\n color = vec4(vec3(0.0), tex.a);\n } else {\n color = tex;\n }\n}","/filters/white.frag":"# version 300 es\nprecision lowp float;\nuniform sampler2D sampler;\nuniform float param;\nin vec2 uv;\nout vec4 color;\nvoid main() {\n vec4 tex = texture(sampler, uv);\n float luminance = 0.2126 * tex.r + 0.7152 * tex.g + 0.0722 * tex.b; // Same as grayscale\n if(luminance >= param) {\n color = vec4(vec3(1.0), tex.a);\n } else {\n color = tex;\n }\n}","/filters/vignette.frag":"# version 300 es\nprecision lowp float;\nuniform sampler2D sampler;\nuniform float param;\nin vec2 uv;\nout vec4 color;\nvoid main() {\n vec4 tex = texture(sampler, uv);\n vec2 pos = (uv * 2.0 - 1.0) * param;\n float dist = 1.0 - sqrt(pos.x * pos.x + pos.y * pos.y);\n color = vec4(tex.rgb * dist, tex.a);\n}","/filters/box.frag":"# version 300 es\nprecision lowp float;\nuniform sampler2D sampler;\nuniform vec2 size;\nuniform float param;\nin vec2 uv;\nout vec4 color;\n#define len (param * 2.0 + 1.0)\n#define count (len * len)\nvoid main() {\n vec4 tex = texture(sampler, uv);\n \n vec4 total = vec4(0.0);\n for(float y = -param; y <= param; y++) {\n for(float x = -param; x <= param; x++) {\n total += texture(sampler, uv + vec2(x, y) / size);\n }\n }\n color = vec4(total / count);\n}","/filters/brightness.frag":"# version 300 es\nprecision lowp float;\nuniform sampler2D sampler;\nuniform float param;\nin vec2 uv;\nout vec4 color;\nvoid main() {\n vec4 tex = texture(sampler, uv);\n \n color = vec4(tex.rgb + param, tex.a);\n}","/filters/TRANSPARENCY.frag":"# version 300 es\n\nprecision lowp float;\n\nuniform sampler2D sampler;\nuniform float param;\n\nin vec2 uv;\nout vec4 color;\n\nvoid main() {\n vec4 tex = texture(sampler, uv);\n \n color = vec4(tex.rgb, tex.a - param);\n}","/filters/transparency.frag":"# version 300 es\nprecision lowp float;\nuniform sampler2D sampler;\nuniform float param;\nin vec2 uv;\nout vec4 color;\nvoid main() {\n vec4 tex = texture(sampler, uv);\n \n color = vec4(tex.rgb, tex.a - param);\n}"},t.compileListKA=[],t.loadFile=function(e){if("www.kasandbox.org"==t.url.host)return t.fileCacheKA[e];{"127.0.0.1:4444"!=t.url.host&&(e="https://cdn.jsdelivr.net/gh/99TheDark/Dark.js@latest"+e);let n=null,i=new XMLHttpRequest;return i.open("GET",e,!1),i.send(),200==i.status&&(n=i.responseText),"127.0.0.1:4444"==t.url.host&&t.compileListKA.push({location:e,contents:n.replace(/\n\n+/g,"\n").replace(/  +/g," ")}),n}},t.compileKA=function(){"127.0.0.1:4444"==t.url.host&&(t.compileListKA.forEach(e=>t.fileCacheKA[e.location]=e.contents),console.log(t.format(t.fileCacheKA)))},t.globallyUpdateVariables=function(e){for(let n in t.empties.forEach(function(t){window[t]&&(e[t]=window[t])}),e)if(!t.ignoreGlobal.includes(n)&&!t.empties.includes(n)){if("object"!=typeof e[n]||e[n].darkObject)window[n]=e[n];else for(let i in e[n])window[i]=e[n][i]}},t.objects=function(){let e=function(e,n,i){switch(this.darkObject=!0,arguments.length){default:t.error(Error("DVector requires 2 or 3 parameters, not "+arguments.length));break;case 3:this.x=e,this.y=n,this.z=i,this.is2D=!1;break;case 2:this.x=e,this.y=n,this.is2D=!0}};e.create=function(t,n,i){return new e(t,n,i)},e.zero2D=function(){return new e(0,0)},e.prototype.zero2D=function(){[this.x,this.y]=[0,0],this.z=void 0,this.is2D=!0},e.zero3D=function(){return new e(0,0,0)},e.prototype.zero3D=function(){[this.x,this.y,this.z]=[0,0,0]},e.add=function(t,n){return n instanceof e?t.is2D?new e(t.x+n.x,t.y+n.y):new e(t.x+n.x,t.y+n.y,t.z+n.z):t.is2D?new e(t.x+n,t.y+n):new e(t.x+n,t.y+n,t.z+n)},e.prototype.add=function(t){t instanceof e?(this.x+=t.x,this.y+=t.y,this.z+=t.z):(this.x+=t,this.y+=t,this.z+=t)},e.sub=function(t,n){return n instanceof e?t.is2D?new e(t.x-n.x,t.y-n.y):new e(t.x-n.x,t.y-n.y,t.z-n.z):t.is2D?new e(t.x-n,t.y-n):new e(t.x-n,t.y-n,t.z-n)},e.prototype.sub=function(t){t instanceof e?(this.x-=t.x,this.y-=t.y,this.z-=t.z):(this.x-=t,this.y-=t,this.z-=t)},e.mult=function(t,n){return n instanceof e?t.is2D?new e(t.x*n.x,t.y*n.y):new e(t.x*n.x,t.y*n.y,t.z*n.z):t.is2D?new e(t.x*n,t.y*n):new e(t.x*n,t.y*n,t.z*n)},e.prototype.mult=function(t){t instanceof e?(this.x*=t.x,this.y*=t.y,this.z*=t.z):(this.x*=t,this.y*=t,this.z*=t)},e.div=function(t,n){return n instanceof e?t.is2D?new e(t.x/n.x,t.y/n.y):new e(t.x/n.x,t.y/n.y,t.z/n.z):t.is2D?new e(t.x/n,t.y/n):new e(t.x/n,t.y/n,t.z/n)},e.prototype.div=function(t){t instanceof e?(this.x/=t.x,this.y/=t.y,this.z/=t.z):(this.x/=t,this.y/=t,this.z/=t)},e.pow=function(t,n){return n instanceof e?new e(t.x**n.x,t.y**n.y,t.z**n.z):new e(t.x**n,t.y**n,t.z**n)},e.prototype.pow=function(t){t instanceof e?(this.x**=t.x,this.y**=t.y,this.z**=t.z):(this.x**=t,this.y**=t,this.z**=t)},e.angle=function(e){return t.utils.atan2(e.y,e.x)},e.prototype.angle=function(){return t.utils.atan2(this.y,this.x)},e.angleBetween=function(e,n){return t.utils.atan2(n.y-e.y,n.x-e.x)},e.prototype.angleBetween=function(t){return e.angleBetween(this,t)},e.mag=function(t){return t.mag()},e.prototype.mag=function(){return this.is2D?Math.sqrt(this.x*this.x+this.y*this.y):Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},e.magSq=function(t){return t.magSq()},e.prototype.magSq=function(){return this.is2D?this.x*this.x+this.y*this.y:this.x*this.x+this.y*this.y+this.z*this.z},e.setMag=function(t,e){t.normalize(),t.mult(e)},e.prototype.setMag=function(t){this.normalize(),this.mult(t)},e.getRotation=function(e){return t.utils.atan2(e.y,e.x)},e.prototype.getRotation=function(){return t.utils.atan2(this.y,this.x)},e.setRotation=function(n,i){let r=n.mag();return new e(r*t.utils.cos(i),r*t.utils.sin(i))},e.prototype.setRotation=function(e){let n=this.mag();[this.x,this.y]=[n*t.utils.cos(e),n*t.utils.sin(e)]},e.rotate=function(t,e){t.setRotation(t.getRotation()+e)},e.prototype.rotate=function(t){this.setRotation(this.getRotation()+t)},e.normalize=function(t){let n=t.mag();return 0!=n?e.div(t,n):t.get()},e.prototype.normalize=function(){let t=this.mag();0!=t&&this.div(t)},e.cross=function(t,n){return new e(t.y*n.z-n.y*t.z,t.z*n.x-n.z*t.x,t.x*n.y-n.x*t.y)},e.prototype.cross=function(t){return this.cross(t)},e.dot=function(e,n){return"number"==typeof n?e.is2D?e.x*n+e.y*n:e.x*n+e.y*n+e.z*n:e.is2D&&n.is2D?e.x*n.x+e.y*n.y:e.is2D||n.is2D?void t.error(Error("Cannot take the dot product of a 2D and 3D vector")):e.x*n.x+e.y*n.y+e.z*n.z},e.prototype.dot=function(t){return e.dot(this,t)},e.flip=function(t){return new Vector(-t.x,-t.y,-t.z)},e.prototype.flip=function(){this.x=-this.x,this.y=-this.y,this.z=-this.z},e.limit=function(t,e){return t.mag()>e&&t.mult(e/t.mag()),t},e.prototype.limit=function(){this.mag()>max&&this.mult(max/this.mag())},e.lerp=function(n,i,r){return new e(t.utils.lerp(n.x,i.x,r),t.utils.lerp(n.y,i.y,r),t.utils.lerp(n.z,i.z,r))},e.prototype.lerp=function(e,n){this.x=t.utils.lerp(this.x,e.x,n),this.y=t.utils.lerp(this.y,e.y,n),this.z=t.utils.lerp(this.z,e.z,n)},e.abs=function(t){return t.is2D?new e(Math.abs(t.x),Math.abs(t.y)):new e(Math.abs(t.x),Math.abs(t.y),Math.abs(t.z))},e.prototype.abs=function(){[this.x,this.y,this.z]=[Math.abs(this.x),Math.abs(this.y),Math.abs(this.z)]},e.dist=function(e,n){let i,r,s=0;return e.is2D&&n.is2D?(i=n.x-e.x,r=n.y-e.y):e.is2D||n.is2D?t.error(Error("Cannot find the distance between a 2D and 3D DVector")):(i=n.x-e.x,r=n.y-e.y,s=n.z-e.z),Math.sqrt(i*i+r*r+s*s)},e.prototype.dist=function(t){return e.dist(this,t)},e.get=function(t){return t.get()},e.prototype.get=function(){return this.is2D?new e(this.x,this.y):new e(this.x,this.y,this.z)},e.set=function(t,e){t.set(e)},e.prototype.set=function(t){Array.isArray(t)?[this.x,this.y,this.z]=t:[this.x,this.y,this.z]=[t.x,t.y,t.z],this.is2D&&(this.z=void 0)},e.toArray=function(t){return t.toArray()},e.prototype.toArray=function(){return this.is2D?[this.x,this.y]:[this.x,this.y,this.z]},e.fromArray=function(t){return e.create.apply(null,t)},e.prototype.fromArray=function(e){switch(e.length){default:t.error(Error("DVector.fromArray takes in an array of length 2 or 3, not "+e.length));break;case 2:[this.x,this.y]=e,this.z=void 0,this.is2D=!0;break;case 3:[this.x,this.y,this.z]=e,this.is2D=!1}},e.prototype.toString=function(){return this.is2D?"["+this.x+", "+this.y+"]":"["+this.x+", "+this.y+", "+this.z+"]"};let n=function(t){this.darkObject=!0,this.style="normal",this.variant="normal",this.weight="normal",this.size=16,this.family="Arial";let e=t.split(" ");for(let i in e){let r=e[i];switch(r){case"normal":break;case"italic":this.style="italic";break;case"bold":this.weight="bold"}if("italic"==r)this.style="italic";else if("small-caps"==r)this.variant="small-caps";else if(n.weights.includes(r))this.weight=r;else if("normal"!==r){let s=parseInt(r);isNaN(s)?this.family=r:this.size=s}}};n.parse=function(t){return new n(t)},n.prototype.toString=function(){return this.style+" "+this.weight+" "+this.variant+" "+this.size+"px "+this.family},n.weights=["bold","bolder","lighter","100","200","300","400","500","600","700","800","900"];let i=function(e,n){this.darkObject=!0,this.filters={},e instanceof ImageData?(this.imageData=e,this.source=n,this.width=e.width,this.height=e.height,this.canvas=new OffscreenCanvas(this.width,this.height),this.ctx=this.canvas.getContext("2d",t.defaultContextSettings),this.loadPixels()):(this.imageData=null,this.source=n,this.width=0,this.height=0)};i.get=function(t,...e){return t.get.apply(null,e)},i.prototype.get=function(...e){return 0==e.length?this.copy():4==e.length?new i(this.ctx.getImageData(e[0],e[1],e[2],e[3]),this.source):void t.error(Error("DImage.get requires 0 or 4 parameters, not "+e.length))},i.set=function(t,...e){t.set.apply(null,e)},i.prototype.set=function(e,n,i){let r=(e+n*this.width)*4;this.imageData.data[r]=t.utils.red(i),this.imageData.data[r+1]=t.utils.green(i),this.imageData.data[r+2]=t.utils.blue(i),this.imageData.data[r+3]=t.utils.alpha(i)},i.copy=function(t){return t.copy()},i.prototype.copy=function(){return new i(this.imageData,this.source)},i.prototype.loadPixels=function(){this.ctx.putImageData(this.imageData,0,0)},i.prototype.updatePixels=function(){this.imageData.data.set(this.ctx.getImageData(0,0,this.width,this.height).data)},i.prototype.filter=function(e,n){if(!t.filters.includes(e))return t.error(Error("Invalid filter type"));{let r=i.filterShaders[e],s=this.filters;if(s.gl_canvas=i.gl_canvas,s.gl=i.gl,[s.gl_canvas.width,s.gl_canvas.height]=[this.width,this.height],s.gl.viewport(0,0,this.width,this.height),!s.gl)return t.warn("Your browser does not support WebGL2.");if(s.vertexSource=i.globalVertexShader,s.fragmentSource=r.shader,s.vertexShader=s.gl.createShader(s.gl.VERTEX_SHADER),s.fragmentShader=s.gl.createShader(s.gl.FRAGMENT_SHADER),s.gl.shaderSource(s.vertexShader,s.vertexSource),s.gl.shaderSource(s.fragmentShader,s.fragmentSource),s.gl.compileShader(s.vertexShader),s.gl.compileShader(s.fragmentShader),!s.gl.getShaderParameter(s.vertexShader,s.gl.COMPILE_STATUS))return t.error(Error("Error compiling vertex shader.\n\n"+s.gl.getShaderInfoLog(s.vertexShader)));if(!s.gl.getShaderParameter(s.fragmentShader,s.gl.COMPILE_STATUS))return t.error(Error("Error compiling fragment shader.\n\n"+s.gl.getShaderInfoLog(s.fragmentShader)));if(s.program=s.gl.createProgram(),s.gl.attachShader(s.program,s.vertexShader),s.gl.attachShader(s.program,s.fragmentShader),s.gl.linkProgram(s.program),!s.gl.getProgramParameter(s.program,s.gl.LINK_STATUS))return t.error(Error("Error linking program.\n\n"+s.gl.getProgramInfoLog(s.program)));if(s.gl.validateProgram(s.program),!s.gl.getProgramParameter(s.program,s.gl.VALIDATE_STATUS))return t.error(Error("Error validating program.\n\n"+s.gl.getProgramInfoLog(s.program)));s.gl.useProgram(s.program),s.tris=s.gl.createBuffer(),s.gl.bindBuffer(s.gl.ARRAY_BUFFER,s.tris),s.gl.bufferData(s.gl.ARRAY_BUFFER,i.texUV,s.gl.STATIC_DRAW),s.fs=Float32Array.BYTES_PER_ELEMENT,s.posAttribLocation=s.gl.getAttribLocation(s.program,"pos"),s.gl.vertexAttribPointer(s.posAttribLocation,2,s.gl.FLOAT,s.gl.FALSE,2*s.fs,0),s.gl.enableVertexAttribArray(s.posAttribLocation),s.sizeUniformLocation=s.gl.getUniformLocation(s.program,"size"),s.gl.uniform2f(s.sizeUniformLocation,this.width,this.height),r.param&&(n=void 0!=n?t.utils.constrain(n,r.param.min,r.param.max):r.param.default,s.paramUniformLocation=s.gl.getUniformLocation(s.program,"param"),s.gl.uniform1f(s.paramUniformLocation,n)),s.texture=s.gl.createTexture(),s.gl.bindTexture(s.gl.TEXTURE_2D,s.texture),s.gl.texParameteri(s.gl.TEXTURE_2D,s.gl.TEXTURE_WRAP_S,s.gl.CLAMP_TO_EDGE),s.gl.texParameteri(s.gl.TEXTURE_2D,s.gl.TEXTURE_WRAP_T,s.gl.CLAMP_TO_EDGE),s.gl.texParameteri(s.gl.TEXTURE_2D,s.gl.TEXTURE_MIN_FILTER,s.gl.LINEAR),s.gl.texParameteri(s.gl.TEXTURE_2D,s.gl.TEXTURE_MAG_FILTER,s.gl.LINEAR),s.gl.texImage2D(s.gl.TEXTURE_2D,0,s.gl.RGBA,s.gl.RGBA,s.gl.UNSIGNED_BYTE,this.imageData),s.gl.bindTexture(s.gl.TEXTURE_2D,null),s.gl.bindTexture(s.gl.TEXTURE_2D,s.texture),s.gl.activeTexture(s.gl.TEXTURE0),s.gl.drawArrays(s.gl.TRIANGLES,0,6);let o=new Uint8ClampedArray(this.width*this.height*4);s.gl.bindFramebuffer(s.gl.FRAMEBUFFER,null),s.gl.readPixels(0,0,this.width,this.height,s.gl.RGBA,s.gl.UNSIGNED_BYTE,o),this.imageData.data.set(o),this.ctx.putImageData(this.imageData,0,0)}},i.texUV=new Float32Array([-1,-1,1,-1,-1,1,1,1,1,-1,-1,1]),i.globalVertexShader=t.loadFile("/filters/global.vert"),i.filterShaders=[],i.initializeShaders=function(e){e.forEach(function(e){i.filterShaders[e.key]={shader:t.loadFile("/filters/"+e.shader+".frag"),param:e.param}})},i.initializeShaders([{key:t.constants.INVERT,shader:"invert"},{key:t.constants.OPAQUE,shader:"opaque"},{key:t.constants.GRAY,shader:"grayscale"},{key:t.constants.THRESHOLD,shader:"threshold",param:{min:0,max:1,default:.5}},{key:t.constants.POSTERIZE,shader:"posterize",param:{min:2,max:255,default:255}},{key:t.constants.BRIGHTNESS,shader:"brightness",param:{min:-1,max:1,default:0}},{key:t.constants.BLACK,shader:"black",param:{min:0,max:1,default:0}},{key:t.constants.WHITE,shader:"white",param:{min:0,max:1,default:1}},{key:t.constants.VIGNETTE,shader:"vignette",param:{min:0,max:1,default:.5}},{key:t.constants.BOX,shader:"box",param:{min:0,max:25,default:1}},{key:t.constants.TRANSPARENCY,shader:"transparency",param:{min:0,max:1,default:0}}]),i.gl_canvas=new OffscreenCanvas(100,60),i.gl=i.gl_canvas.getContext("webgl2");let r=function(t,e,n=0){this.darkObject=!0,t instanceof r?(this.width=t.width,this.height=t.height,this.mat=Array(this.height).fill(null).map(()=>Array(this.width).fill(0)),this.set(t)):Array.isArray(t)?(Array.isArray(t[0])?(this.width=t[0].length,this.height=t.length):(this.width=e,this.height=n),this.mat=Array(this.height).fill(null).map(()=>Array(this.width).fill(0)),this.set(t)):(this.width=t,this.height=e,this.mat=Array(e).fill(null).map(()=>Array(t).fill(n)))};return r.prototype.get=function(t,e){return this.mat[e][t]},r.set=function(t,e,n,i){t.set(e,n,i)},r.prototype.set=function(t,e,n){if(t instanceof r)for(let i=0;i<t.height;i++)for(let s=0;s<t.width;s++)this.mat[i][s]=t.mat[i][s];else if(Array.isArray(t)){if(Array.isArray(t[0]))for(let o=0;o<t.length;o++)for(let a=0;a<t[0].length;a++)this.mat[o][a]=t[o][a];else for(let l=0;l<this.width*this.height;l++){let c=l%this.width,u=Math.floor(l/this.width);this.mat[u][c]=t[l]}}else this.mat[e][t]=n},r.dot=function(e,n,i,r){if(e.width==n.height){let s=0;for(let o=0;o<e.width;o++)s+=e.get(o,i)*n.get(r,o);return s}t.error(Error("Can only take the dot product of two DMatrices  with equal width and height"))},r.prototype.dot=function(t){return r.dot(this,t)},r.identity=function(t){let e=new r(t,t);for(let n=0;n<t;n++)e.set(n,n,1);return e},r.prototype.identity=function(){this.width==this.height?this.mat=r.identity(this.width).mat:t.error(Error("Only DMatrices with square dimensions have identity DMatrices"))},r.add=function(e,n){if("number"==typeof n){let i=new r(e.width,e.height);for(let s=0;s<i.height;s++)for(let o=0;o<i.width;o++)i.set(s,o,e.get(o,s)+n);return i}if(e.width==n.width&&e.height==n.height){let a=new r(e.width,e.height);for(let l=0;l<a.height;l++)for(let c=0;c<a.width;c++)a.set(l,c,e.get(c,l)+n.get(c,l));return a}t.error(Error("Cannot add two DMatrices with different dimensions"))},r.prototype.add=function(t){this.set(r.add(this,t))},r.sub=function(e,n){if("number"==typeof n){let i=new r(e.width,e.height);for(let s=0;s<i.height;s++)for(let o=0;o<i.width;o++)i.set(s,o,e.get(o,s)-n);return i}if(e.width==n.width&&e.height==n.height){let a=new r(e.width,e.height);for(let l=0;l<a.height;l++)for(let c=0;c<a.width;c++)a.set(l,c,e.get(c,l)-n.get(c,l));return a}t.error(Error("Cannot subtract two DMatrices with different dimensions"))},r.prototype.sub=function(t){this.set(r.sub(this,t))},r.mult=function(e,n){if("number"==typeof n){let i=new r(e.width,e.height);for(let s=0;s<i.height;s++)for(let o=0;o<i.width;o++)i.set(s,o,e.get(o,s)*n);return i}if(e.width==n.height){let a=new r(n.width,e.height);for(let l=0;l<a.height;l++)for(let c=0;c<a.width;c++)a.set(c,l,r.dot(e,n,l,c));return a}t.error(Error("Can only multiply two DMatrices with equal width and height"))},r.prototype.mult=function(t){let e=r.mult(this,t);this.width=e.width,this.height=e.height,this.mat=e.mat},r.prototype.copy=function(){return new r([...this.mat])},r.prototype.toArray=function(){return[...this.mat]},r.prototype.toString=function(){let t="";for(let e in this.mat){for(let n in this.mat[e])t+=this.mat[e][n]+" ";t=t.replace(/ $/,"\n")}return t},{DVector:e,DFont:n,DImage:i,DMatrix:r}}(),t.compileKA(),t.utils=new t(!0),t.setMain(new t),t.globallyUpdateVariables(t.main),t.version="0.5.5.3",Object.freeze(t)}
